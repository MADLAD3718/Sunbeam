import{world as zr}from"@minecraft/server";import{Direction as j}from"@minecraft/server";var w;(r=>{r.Zero={x:0,y:0,z:0},r.One={x:1,y:1,z:1},r.Up={x:0,y:1,z:0},r.Down={x:0,y:-1,z:0},r.North={x:0,y:0,z:-1},r.South={x:0,y:0,z:1},r.East={x:1,y:0,z:0},r.West={x:-1,y:0,z:0},r.X=r.East,r.Y=r.Up,r.Z=r.South;function t(e){return typeof e=="object"&&"x"in e&&"y"in e&&"z"in e}r.isVector3=t;function i(e,u,M){if(typeof e=="number")return{x:e,y:u??e,z:M??e};if(Array.isArray(e)&&e.length>=3)return{x:e[0],y:e[1],z:e[2]};throw new Error("Invalid input values for vector construction.")}r.from=i;function s(e){switch(e){case"up":return r.Up;case"down":return r.Down;case"north":return r.North;case"south":return r.South;case"east":return r.East;case"west":return r.West}throw new Error("Argument was not of type 'block_face' or 'cardinal_direction'.")}r.fromBlockFace=s;function a(e){return m(e).toLowerCase()}r.toBlockFace=a;function c(e){switch(e){case j.Up:return r.Up;case j.Down:return r.Down;case j.North:return r.North;case j.South:return r.South;case j.East:return r.East;case j.West:return r.West}}r.fromDirection=c;function m(e){let u=et(e),M=Math.max(u.x,u.y,u.z);return M===u.x?e.x>=0?j.East:j.West:M===u.y?e.y>=0?j.Up:j.Down:e.z>=0?j.South:j.North}r.toDirection=m;function g(e){return{x:e.red,y:e.green,z:e.blue}}r.fromRGB=g;function p(e){return{red:e.x,green:e.y,blue:e.z}}r.toRGB=p;function E(e){return{x:-x(Math.asin(e.y)),y:-x(Math.atan2(e.x,e.z))}}r.toRotation=E;function x(e){return 180*e/Math.PI}function b(e){let{x:u,y:M,z:N}=e;return[u,M,N]}r.toArray=b;function D(e){return b(e).join(" ")}r.toString=D;function k(e){let[u,M,N]=e.split(" ").map(Number);return{x:u,y:M,z:N}}r.parse=k;function y(e){return Number.isNaN(e.x)||Number.isNaN(e.y)||Number.isNaN(e.z)}r.isNaN=y;function S(e){return!Z(e)}r.isInf=S;function Z(e){return Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)}r.isFinite=Z;function o(e,u){return e.x===u.x&&e.y===u.y&&e.z===u.z}r.equal=o;function z(e,u){return{x:Math.min(e.x,u.x),y:Math.min(e.y,u.y),z:Math.min(e.z,u.z)}}r.min=z;function U(e,u){return{x:Math.max(e.x,u.x),y:Math.max(e.y,u.y),z:Math.max(e.z,u.z)}}r.max=U;function mt(e,u,M){return{x:Math.min(Math.max(e.x,u.x),M.x),y:Math.min(Math.max(e.y,u.y),M.y),z:Math.min(Math.max(e.z,u.z),M.z)}}r.clamp=mt;function yt(e){return{x:Math.min(Math.max(e.x,0),1),y:Math.min(Math.max(e.y,0),1),z:Math.min(Math.max(e.z,0),1)}}r.saturate=yt;function dt(e){return{x:Math.sign(e.x),y:Math.sign(e.y),z:Math.sign(e.z)}}r.sign=dt;function pt(e){return{x:Math.floor(e.x),y:Math.floor(e.y),z:Math.floor(e.z)}}r.floor=pt;function _(e){return{x:Math.ceil(e.x),y:Math.ceil(e.y),z:Math.ceil(e.z)}}r.ceil=_;function Q(e){return{x:e.x-Math.floor(e.x),y:e.y-Math.floor(e.y),z:e.z-Math.floor(e.z)}}r.frac=Q;function F(e){return{x:Math.round(e.x),y:Math.round(e.y),z:Math.round(e.z)}}r.round=F;function rt(e,u){return{x:e.x%u.x,y:e.y%u.y,z:e.z%u.z}}r.mod=rt;function gt(e){return{x:-e.x,y:-e.y,z:-e.z}}r.neg=gt;function et(e){return{x:Math.abs(e.x),y:Math.abs(e.y),z:Math.abs(e.z)}}r.abs=et;function O(e,...u){for(let M of u)e={x:e.x+M.x,y:e.y+M.y,z:e.z+M.z};return e}r.add=O;function K(e,...u){for(let M of u)e={x:e.x-M.x,y:e.y-M.y,z:e.z-M.z};return e}r.sub=K;function C(e,u){return t(u)?{x:e.x*u.x,y:e.y*u.y,z:e.z*u.z}:{x:e.x*u,y:e.y*u,z:e.z*u}}r.mul=C;function nt(e,u){return t(u)?{x:e.x/u.x,y:e.y/u.y,z:e.z/u.z}:{x:e.x/u,y:e.y/u,z:e.z/u}}r.div=nt;function xt(e){return{x:Math.sqrt(e.x),y:Math.sqrt(e.y),z:Math.sqrt(e.z)}}r.sqrt=xt;function Mt(e){return{x:Math.exp(e.x),y:Math.exp(e.y),z:Math.exp(e.z)}}r.exp=Mt;function Et(e){return{x:Math.pow(2,e.x),y:Math.pow(2,e.y),z:Math.pow(2,e.z)}}r.exp2=Et;function zt(e){return{x:Math.log(e.x),y:Math.log(e.y),z:Math.log(e.z)}}r.log=zt;function wt(e){return{x:Math.log2(e.x),y:Math.log2(e.y),z:Math.log2(e.z)}}r.log2=wt;function At(e){return{x:Math.log10(e.x),y:Math.log10(e.y),z:Math.log10(e.z)}}r.log10=At;function bt(e,u){return t(u)?{x:Math.pow(e.x,u.x),y:Math.pow(e.y,u.y),z:Math.pow(e.z,u.z)}:{x:Math.pow(e.x,u),y:Math.pow(e.y,u),z:Math.pow(e.z,u)}}r.pow=bt;function Rt(e){return{x:Math.sin(e.x),y:Math.sin(e.y),z:Math.sin(e.z)}}r.sin=Rt;function St(e){return{x:Math.asin(e.x),y:Math.asin(e.y),z:Math.asin(e.z)}}r.asin=St;function Tt(e){return{x:Math.sinh(e.x),y:Math.sinh(e.y),z:Math.sinh(e.z)}}r.sinh=Tt;function It(e){return{x:Math.asinh(e.x),y:Math.asinh(e.y),z:Math.asinh(e.z)}}r.asinh=It;function Ct(e){return{x:Math.cos(e.x),y:Math.cos(e.y),z:Math.cos(e.z)}}r.cos=Ct;function Dt(e){return{x:Math.acos(e.x),y:Math.acos(e.y),z:Math.acos(e.z)}}r.acos=Dt;function B(e){return{x:Math.cosh(e.x),y:Math.cosh(e.y),z:Math.cosh(e.z)}}r.cosh=B;function Lt(e){return{x:Math.acosh(e.x),y:Math.acosh(e.y),z:Math.acosh(e.z)}}r.acosh=Lt;function V(e){return{x:Math.tan(e.x),y:Math.tan(e.y),z:Math.tan(e.z)}}r.tan=V;function Ot(e){return{x:Math.atan(e.x),y:Math.atan(e.y),z:Math.atan(e.z)}}r.atan=Ot;function Nt(e){return{x:Math.tanh(e.x),y:Math.tanh(e.y),z:Math.tanh(e.z)}}r.tanh=Nt;function it(e){return{x:Math.atanh(e.x),y:Math.atanh(e.y),z:Math.atanh(e.z)}}r.atanh=it;function Pt(e,u=1){return O(e,C(r.Up,u))}r.above=Pt;function jt(e,u=1){return O(e,C(r.Down,u))}r.below=jt;function kt(e,u=1){return O(e,C(r.North,u))}r.north=kt;function Ut(e,u=1){return O(e,C(r.South,u))}r.south=Ut;function qt(e,u=1){return O(e,C(r.East,u))}r.east=qt;function Ft(e,u=1){return O(e,C(r.West,u))}r.west=Ft;function n(e,u){return e.x*u.x+e.y*u.y+e.z*u.z}r.dot=n;function f(e,u){return{x:e.y*u.z-e.z*u.y,y:e.z*u.x-e.x*u.z,z:e.x*u.y-e.y*u.x}}r.cross=f;function A(e){return Math.hypot(e.x,e.y,e.z)}r.length=A;function P(e){return nt(e,A(e))}r.normalize=P;function G(e,u){return A(K(e,u))}r.distance=G;function H(e,u){return C(u,n(e,u)/n(u,u))}r.project=H;function Bt(e,u){return K(e,H(e,u))}r.reject=Bt;function Gt(e,u){return K(e,C(u,2*n(u,e)))}r.reflect=Gt;function hr(e,u,M){let N=-n(e,u),J=M*M*(1-N*N),Y=Math.sqrt(1-J);return O(C(e,M),C(u,M*N-Y))}r.refract=hr;function cr(e,u,M){return M===0?e:M===1?u:{x:e.x+M*(u.x-e.x),y:e.y+M*(u.y-e.y),z:e.z+M*(u.z-e.z)}}r.lerp=cr;function lr(e,u,M){if(M===0)return e;if(M===1)return u;let N=n(e,u),J=Math.acos(N),Y=Math.sqrt(1-N*N),$t=Math.sin((1-M)*J)/Y,Wt=Math.sin(M*J)/Y;return O(C(e,$t),C(u,Wt))}r.slerp=lr;function fr(e,u,M){let N=Math.cos(M),J=Math.sin(M),Y=C(u,n(e,u)),$t=K(e,Y),Wt=f(u,e);return O(Y,O(C($t,N),C(Wt,J)))}r.rotate=fr})(w||(w={}));var $;(r=>{r.Identity={m11:1,m12:0,m13:0,m21:0,m22:1,m23:0,m31:0,m32:0,m33:1};function t(o){return typeof o=="object"&&"m11"in o&&"m12"in o&&"m13"in o&&"m21"in o&&"m22"in o&&"m23"in o&&"m31"in o&&"m32"in o&&"m33"in o}r.isMatrix3=t;function i(o,z,U){if(Array.isArray(o)&&o.length>=9)return{m11:o[0],m12:o[1],m13:o[2],m21:o[3],m22:o[4],m23:o[5],m31:o[6],m32:o[7],m33:o[8]};if(w.isVector3(o)&&z&&U)return{m11:o.x,m12:z.x,m13:U.x,m21:o.y,m22:z.y,m23:U.y,m31:o.z,m32:z.z,m33:U.z};throw new Error("Invalid input values for vector construction.")}r.from=i;function s(o){return{x:o.m11,y:o.m21,z:o.m31}}r.c1=s;function a(o){return{x:o.m12,y:o.m22,z:o.m32}}r.c2=a;function c(o){return{x:o.m13,y:o.m23,z:o.m33}}r.c3=c;function m(o){return{x:o.m11,y:o.m12,z:o.m13}}r.r1=m;function g(o){return{x:o.m21,y:o.m22,z:o.m23}}r.r2=g;function p(o){return{x:o.m31,y:o.m32,z:o.m33}}r.r3=p;function E(o,z){return t(z)?{m11:w.dot(m(o),s(z)),m12:w.dot(m(o),a(z)),m13:w.dot(m(o),c(z)),m21:w.dot(g(o),s(z)),m22:w.dot(g(o),a(z)),m23:w.dot(g(o),c(z)),m31:w.dot(p(o),s(z)),m32:w.dot(p(o),a(z)),m33:w.dot(p(o),c(z))}:w.isVector3(z)?{x:w.dot(m(o),z),y:w.dot(g(o),z),z:w.dot(p(o),z)}:{m11:o.m11*z,m12:o.m12*z,m13:o.m13*z,m21:o.m21*z,m22:o.m22*z,m23:o.m23*z,m31:o.m31*z,m32:o.m32*z,m33:o.m33*z}}r.mul=E;function x(o){return o.m11+o.m22+o.m33}r.trace=x;function b(o){return o.m11*o.m22*o.m33+o.m21*o.m32*o.m13+o.m31*o.m12*o.m23-o.m13*o.m22*o.m31-o.m23*o.m32*o.m11-o.m33*o.m12*o.m21}r.determinant=b;function D(o){return{m11:o.m11,m12:o.m21,m13:o.m31,m21:o.m12,m22:o.m22,m23:o.m32,m31:o.m13,m32:o.m23,m33:o.m33}}r.transpose=D;function k(o){return{m11:o.m22*o.m33-o.m23*o.m32,m12:o.m23*o.m31-o.m21*o.m33,m13:o.m21*o.m32-o.m22*o.m31,m21:o.m13*o.m32-o.m12*o.m33,m22:o.m11*o.m33-o.m13*o.m31,m23:o.m12*o.m31-o.m11*o.m32,m31:o.m12*o.m23-o.m13*o.m22,m32:o.m13*o.m21-o.m11*o.m23,m33:o.m11*o.m22-o.m12*o.m21}}r.cofactor=k;function y(o){return{m11:o.m22*o.m33-o.m23*o.m32,m12:o.m13*o.m32-o.m12*o.m33,m13:o.m12*o.m23-o.m13*o.m22,m21:o.m23*o.m31-o.m21*o.m33,m22:o.m11*o.m33-o.m13*o.m31,m23:o.m13*o.m21-o.m11*o.m23,m31:o.m21*o.m32-o.m22*o.m31,m32:o.m12*o.m31-o.m11*o.m32,m33:o.m11*o.m22-o.m12*o.m21}}r.adjugate=y;function S(o){let z=b(o);if(z===0)throw new Error("Matrix is not invertible.");return E(y(o),1/z)}r.inverse=S;function Z(o){let z=Math.abs(o.y)===1?w.East:w.normalize(w.from(o.z,0,-o.x)),U=w.cross(z,o);return i(z,o,U)}r.buildTNB=Z})($||($={}));var ot;(r=>{r.Identity={m11:1,m12:0,m21:0,m22:1};function t(y){return typeof y=="object"&&"m11"in y&&"m12"in y&&"m21"in y&&"m22"in y}r.isMatrix2=t;function i(y,S){if(Array.isArray(y)&&y.length>=4)return{m11:y[0],m12:y[1],m21:y[2],m22:y[3]};if(q.isVector2(y)&&S)return{m11:y.x,m12:S.x,m21:y.y,m22:S.y};throw new Error("Invalid input values for vector construction.")}r.from=i;function s(y){return{x:y.m11,y:y.m21}}r.c1=s;function a(y){return{x:y.m12,y:y.m22}}r.c2=a;function c(y){return{x:y.m11,y:y.m12}}r.r1=c;function m(y){return{x:y.m21,y:y.m22}}r.r2=m;function g(y,S){return t(S)?{m11:q.dot(c(y),s(S)),m12:q.dot(c(y),a(S)),m21:q.dot(m(y),s(S)),m22:q.dot(m(y),a(S))}:q.isVector2(S)?{x:q.dot(c(y),S),y:q.dot(m(y),S)}:{m11:y.m11*S,m12:y.m12*S,m21:y.m21*S,m22:y.m22*S}}r.mul=g;function p(y){return y.m11+y.m22}r.trace=p;function E(y){return y.m11*y.m22-y.m12*y.m21}r.determinant=E;function x(y){return{m11:y.m11,m12:y.m21,m21:y.m12,m22:y.m22}}r.transpose=x;function b(y){return{m11:y.m22,m12:-y.m21,m21:-y.m12,m22:y.m11}}r.cofactor=b;function D(y){return{m11:y.m22,m12:-y.m12,m21:-y.m21,m22:y.m11}}r.adjugate=D;function k(y){let S=E(y);if(S===0)throw new Error("Matrix is not invertible.");return g(D(y),1/S)}r.inverse=k})(ot||(ot={}));var q;(r=>{r.Zero={x:0,y:0},r.One={x:1,y:1},r.Up={x:0,y:1},r.Down={x:0,y:-1},r.Left={x:-1,y:0},r.Right={x:1,y:0},r.X=r.Right,r.Y=r.Up;function t(n){return typeof n=="object"&&"x"in n&&"y"in n}r.isVector2=t;function i(n,f){if(Array.isArray(n)&&n.length>=2)return{x:n[0],y:n[1]};if(typeof n=="number")return{x:n,y:f??n};throw new Error("Invalid input values for vector construction.")}r.from=i;function s(n){return{x:n.x,y:n.z}}r.fromVectorXZ=s;function a(n){return{x:n.x,z:n.y}}r.toVectorXZ=a;function c(n){let{x:f,y:A}=n;return[f,A]}r.toArray=c;function m(n){return c(n).join(" ")}r.toString=m;function g(n){let[f,A]=n.split(" ").map(Number);return{x:f,y:A}}r.parse=g;function p(n){return Number.isNaN(n.x)||Number.isNaN(n.y)}r.isNaN=p;function E(n){return!x(n)}r.isInf=E;function x(n){return Number.isFinite(n.x)&&Number.isFinite(n.y)}r.isFinite=x;function b(n,f){return n.x===f.x&&n.y===f.y}r.equal=b;function D(n,f){return{x:Math.min(n.x,f.x),y:Math.min(n.y,f.y)}}r.min=D;function k(n,f){return{x:Math.max(n.x,f.x),y:Math.max(n.y,f.y)}}r.max=k;function y(n,f,A){return{x:Math.min(Math.max(n.x,f.x),A.x),y:Math.min(Math.max(n.y,f.y),A.y)}}r.clamp=y;function S(n){return{x:Math.min(Math.max(n.x,0),1),y:Math.min(Math.max(n.y,0),1)}}r.saturate=S;function Z(n){return{x:Math.sign(n.x),y:Math.sign(n.y)}}r.sign=Z;function o(n){return{x:Math.floor(n.x),y:Math.floor(n.y)}}r.floor=o;function z(n){return{x:Math.ceil(n.x),y:Math.ceil(n.y)}}r.ceil=z;function U(n){return{x:n.x-Math.floor(n.x),y:n.y-Math.floor(n.y)}}r.frac=U;function mt(n){return{x:Math.round(n.x),y:Math.round(n.y)}}r.round=mt;function yt(n,f){return{x:n.x%f.x,y:n.y%f.y}}r.mod=yt;function dt(n){return{x:-n.x,y:-n.y}}r.neg=dt;function pt(n){return{x:Math.abs(n.x),y:Math.abs(n.y)}}r.abs=pt;function _(n,...f){for(let A of f)n={x:n.x+A.x,y:n.y+A.y};return n}r.add=_;function Q(n,...f){for(let A of f)n={x:n.x-A.x,y:n.y-A.y};return n}r.sub=Q;function F(n,f){return t(f)?{x:n.x*f.x,y:n.y*f.y}:{x:n.x*f,y:n.y*f}}r.mul=F;function rt(n,f){return t(f)?{x:n.x/f.x,y:n.y/f.y}:{x:n.x/f,y:n.y/f}}r.div=rt;function gt(n){return{x:Math.sqrt(n.x),y:Math.sqrt(n.y)}}r.sqrt=gt;function et(n){return{x:Math.exp(n.x),y:Math.exp(n.y)}}r.exp=et;function O(n){return{x:Math.pow(2,n.x),y:Math.pow(2,n.y)}}r.exp2=O;function K(n){return{x:Math.log(n.x),y:Math.log(n.y)}}r.log=K;function C(n){return{x:Math.log2(n.x),y:Math.log2(n.y)}}r.log2=C;function nt(n){return{x:Math.log10(n.x),y:Math.log10(n.y)}}r.log10=nt;function xt(n,f){return t(f)?{x:Math.pow(n.x,f.x),y:Math.pow(n.y,f.y)}:{x:Math.pow(n.x,f),y:Math.pow(n.y,f)}}r.pow=xt;function Mt(n){return{x:Math.sin(n.x),y:Math.sin(n.y)}}r.sin=Mt;function Et(n){return{x:Math.asin(n.x),y:Math.asin(n.y)}}r.asin=Et;function zt(n){return{x:Math.sinh(n.x),y:Math.sinh(n.y)}}r.sinh=zt;function wt(n){return{x:Math.asinh(n.x),y:Math.asinh(n.y)}}r.asinh=wt;function At(n){return{x:Math.cos(n.x),y:Math.cos(n.y)}}r.cos=At;function bt(n){return{x:Math.acos(n.x),y:Math.acos(n.y)}}r.acos=bt;function Rt(n){return{x:Math.cosh(n.x),y:Math.cosh(n.y)}}r.cosh=Rt;function St(n){return{x:Math.acosh(n.x),y:Math.acosh(n.y)}}r.acosh=St;function Tt(n){return{x:Math.tan(n.x),y:Math.tan(n.y)}}r.tan=Tt;function It(n){return{x:Math.atan(n.x),y:Math.atan(n.y)}}r.atan=It;function Ct(n){return{x:Math.tanh(n.x),y:Math.tanh(n.y)}}r.tanh=Ct;function Dt(n){return{x:Math.atanh(n.x),y:Math.atanh(n.y)}}r.atanh=Dt;function B(n,f){return n.x*f.x+n.y*f.y}r.dot=B;function Lt(n,f){return n.x*f.y-n.y*f.x}r.wedge=Lt;function V(n){return Math.hypot(n.x,n.y)}r.length=V;function Ot(n){return rt(n,V(n))}r.normalize=Ot;function Nt(n,f){return V(Q(n,f))}r.distance=Nt;function it(n,f){return F(f,B(n,f)/B(f,f))}r.project=it;function Pt(n,f){return Q(n,it(n,f))}r.reject=Pt;function jt(n,f){return Q(n,F(f,2*B(f,n)))}r.reflect=jt;function kt(n,f,A){let P=-B(n,f),G=A*A*(1-P*P),H=Math.sqrt(1-G);return _(F(n,A),F(f,A*P-H))}r.refract=kt;function Ut(n,f,A){return A===0?n:A===1?f:{x:n.x+A*(f.x-n.x),y:n.y+A*(f.y-n.y)}}r.lerp=Ut;function qt(n,f,A){if(A===0)return n;if(A===1)return f;let P=B(n,f),G=Math.acos(P),H=Math.sqrt(1-P*P),Bt=Math.sin((1-A)*G)/H,Gt=Math.sin(A*G)/H;return _(F(n,Bt),F(f,Gt))}r.slerp=qt;function Ft(n,f){let A=Math.cos(f),P=Math.sin(f),G=ot.from([A,-P,P,A]);return ot.mul(G,n)}r.rotate=Ft})(q||(q={}));var vt;(r=>{function t(){return{x:Math.random(),y:Math.random()}}r.random2=t;function i(){return{x:Math.random(),y:Math.random(),z:Math.random()}}r.random3=i;function s(){let E=Math.random()*Math.PI*2;return{x:Math.cos(E),y:Math.sin(E)}}r.circle=s;function a(){let E=t(),x=E.x*Math.PI*2,b=Math.sqrt(E.y);return{x:b*Math.cos(x),y:b*Math.sin(x)}}r.disk=a;function c(){let E=t(),x=E.x*Math.PI*2,b=2*Math.sqrt(E.y*(1-E.y));return{x:Math.cos(x)*b,y:1-2*E.y,z:Math.sin(x)*b}}r.sphere=c;function m(){let E=t(),x=E.x*Math.PI*2,b=Math.sqrt(E.y*(2-E.y));return{x:Math.cos(x)*b,y:1-E.y,z:Math.sin(x)*b}}r.hemisphere=m;function g(){let E=t(),x=E.x*Math.PI*2,b=Math.sqrt(E.y);return{x:Math.cos(x)*b,y:Math.sqrt(1-E.y),z:Math.sin(x)*b}}r.cosHemisphere=g;function p(E){let x=t(),b=x.x*Math.PI*2,D=x.y*(1-Math.cos(E)),k=Math.sqrt(D*(2-D));return{x:Math.cos(b)*k,y:1-D,z:Math.sin(b)*k}}r.cap=p})(vt||(vt={}));import{WeatherType as Mr,world as Yt}from"@minecraft/server";import{Direction as R}from"@minecraft/server";import{system as mr,world as tt}from"@minecraft/server";import{system as Fr}from"@minecraft/server";import{BlockPermutation as Gr,world as $r}from"@minecraft/server";import{world as Kr}from"@minecraft/server";import{Player as Yr}from"@minecraft/server";import{system as Kt}from"@minecraft/server";import{EquipmentSlot as Jr}from"@minecraft/server";import{system as _t}from"@minecraft/server";import{MinecraftDimensionTypes as Vr,world as te}from"@minecraft/server";import{Player as xr,system as Vt,world as st}from"@minecraft/server";var d=class l{constructor(t,i){this.code=t,this.color=i,i&&(this.r=i>>16&255,this.g=i>>8&255,this.b=i&255)}static BLACK=new l("0",0);static DARK_BLUE=new l("1",170);static DARK_GREEN=new l("2",43520);static DARK_AQUA=new l("3",43690);static DARK_RED=new l("4",11141120);static DARK_PURPLE=new l("5",11141290);static GOLD=new l("6",16755200);static GRAY=new l("7",11184810);static DARK_GRAY=new l("8",5592405);static BLUE=new l("9",5592575);static GREEN=new l("a",5635925);static AQUA=new l("b",5636095);static RED=new l("c",16733525);static LIGHT_PURPLE=new l("d",16733695);static YELLOW=new l("e",16777045);static WHITE=new l("f",16777215);static MINECOIN_GOLD=new l("g",14603781);static MATERIAL_QUARTZ=new l("h",14931153);static MATERIAL_IRON=new l("i",13552330);static MATERIAL_NETHERITE=new l("j",4471355);static MATERIAL_REDSTONE=new l("m",9901575);static MATERIAL_COPPER=new l("n",11823181);static MATERIAL_GOLD=new l("p",14594349);static MATERIAL_EMERALD=new l("q",1155126);static MATERIAL_DIAMOND=new l("s",2931368);static MATERIAL_LAPIS=new l("t",2181499);static MATERIAL_AMETHYST=new l("u",10116294);static OBFUSCATED=new l("k");static BOLD=new l("l");static ITALIC=new l("o");static RESET=new l("r");static VALUES=[l.BLACK,l.DARK_BLUE,l.DARK_GREEN,l.DARK_AQUA,l.DARK_RED,l.DARK_PURPLE,l.GOLD,l.GRAY,l.DARK_GRAY,l.BLUE,l.GREEN,l.AQUA,l.RED,l.LIGHT_PURPLE,l.YELLOW,l.WHITE,l.MINECOIN_GOLD,l.MATERIAL_QUARTZ,l.MATERIAL_IRON,l.MATERIAL_NETHERITE,l.MATERIAL_REDSTONE,l.MATERIAL_COPPER,l.MATERIAL_GOLD,l.MATERIAL_EMERALD,l.MATERIAL_DIAMOND,l.MATERIAL_LAPIS,l.MATERIAL_AMETHYST,l.OBFUSCATED,l.BOLD,l.ITALIC,l.RESET];static ALL_COLORS=[l.BLACK,l.DARK_BLUE,l.DARK_GREEN,l.DARK_AQUA,l.DARK_RED,l.DARK_PURPLE,l.GOLD,l.GRAY,l.DARK_GRAY,l.BLUE,l.GREEN,l.AQUA,l.RED,l.LIGHT_PURPLE,l.YELLOW,l.WHITE,l.MINECOIN_GOLD,l.MATERIAL_QUARTZ,l.MATERIAL_IRON,l.MATERIAL_NETHERITE,l.MATERIAL_REDSTONE,l.MATERIAL_COPPER,l.MATERIAL_GOLD,l.MATERIAL_EMERALD,l.MATERIAL_DIAMOND,l.MATERIAL_LAPIS,l.MATERIAL_AMETHYST];r;g;b;static PREFIX="\xA7";toString(){return l.PREFIX+this.code}toRGB(){return this.color}toHex(){var t;return(t=this.color)==null?void 0:t.toString(16)}getRed(){return this.r}getGreen(){return this.g}getBlue(){return this.b}getCode(){return this.code}static stripColor(t){return t.replace(/§[0-9a-u]/g,"")}static findClosestColor(t,i,s){let a=Number.MAX_VALUE,c=l.WHITE;for(let m of l.ALL_COLORS)if(m.r&&m.g&&m.b){let g=Math.sqrt(Math.pow(m.r-t,2)+Math.pow(m.g-i,2)+Math.pow(m.b-s,2));g<a&&(a=g,c=m)}return c}},yr=class tr{OpenObject="{";CloseObject="}";OpenArray="[";CloseArray="]";Comma=",";KeyValueSeparator=":";StringDelimiter='"';KeyDelimiter="";Indent="  ";NewLine=`
`;Space=" ";InlineThreshold=60;MaxDepth=1;IncludeClassNames=!0;FunctionValue="\u0192";NullValue="null";UndefinedValue="undefined";TrueValue="true";FalseValue="false";CycleValue="[...cycle...]";TruncatedObjectValue="{...}";OpenCloseObjectColor=d.YELLOW;OpenCloseArrayColor=d.AQUA;NumberColor=d.DARK_AQUA;StringColor=d.DARK_GREEN;BooleanColor=d.GOLD;NullColor=d.GOLD;KeyColor=d.GRAY;EscapeColor=d.GOLD;FunctionColor=d.GRAY;ClassColor=d.GRAY;ClassStyle=d.BOLD;CycleColor=d.DARK_RED;static DEFAULT=new tr;stringify(t){return this.stringifyValue(t)}stringifyString(t){return this.StringColor+this.StringDelimiter+this.escapeString(t)+this.StringDelimiter+d.RESET}stringifyNumber(t){return this.NumberColor+t.toString()+d.RESET}stringifyBoolean(t){return this.BooleanColor+(t?this.TrueValue:this.FalseValue)+d.RESET}stringifyFunction(t){return this.FunctionColor+this.FunctionValue+d.RESET}stringifyNull(){return this.NullColor+this.NullValue+d.RESET}stringifyUndefined(){return this.NullColor+this.UndefinedValue+d.RESET}stringifyCycle(){return this.CycleColor+this.CycleValue+d.RESET}stringifyArray(t,i=0){let s=this.Indent.repeat(i);if(t.length===0)return this.OpenCloseArrayColor+this.OpenArray+this.CloseArray+d.RESET;let a=this.OpenCloseArrayColor+this.OpenArray+d.RESET+this.NewLine,c=this.OpenCloseArrayColor+this.OpenArray+d.RESET;return t.forEach((m,g)=>{a+=s+this.Indent+this.stringifyValue(m,i+1),a+=g<t.length-1?this.Comma+this.NewLine:this.NewLine,c+=this.stringifyValue(m,i+1),c+=g<t.length-1?this.Comma+this.Space:""}),a+=s+this.OpenCloseArrayColor+this.CloseArray+d.RESET,c+=this.OpenCloseArrayColor+this.CloseArray+d.RESET,c.length<this.InlineThreshold?c:a}stringifyTruncatedObject(t,i,s=0){return(this.IncludeClassNames?this.ClassColor+""+this.ClassStyle+i+d.RESET+this.Space:"")+this.TruncatedObjectValue}stringifyObject(t,i,s,a=0){let c=this.Indent.repeat(a),m=this.IncludeClassNames&&i!=="Object"?this.ClassColor+""+this.ClassStyle+i+d.RESET+this.Space:"";if(s.length===0)return m+this.OpenCloseObjectColor+this.OpenObject+this.CloseObject+d.RESET;let g=m+this.OpenCloseObjectColor+this.OpenObject+d.RESET+this.NewLine,p=m+this.OpenCloseObjectColor+this.OpenObject+d.RESET;return s.forEach(([E,x],b)=>{let D=this.stringifyValue(x,a+1);g+=c+this.Indent+this.KeyColor+this.KeyDelimiter+E+this.KeyDelimiter+d.RESET+this.KeyValueSeparator+this.Space+D,g+=b<s.length-1?this.Comma+this.NewLine:this.NewLine,p+=this.KeyColor+E+d.RESET+this.KeyValueSeparator+this.Space+D,p+=b<s.length-1?this.Comma+this.Space:""}),g+=c+this.OpenCloseObjectColor+this.CloseObject+d.RESET,p+=this.OpenCloseObjectColor+this.CloseObject+d.RESET,p.length<this.InlineThreshold?p:g}shouldTruncateObject(t,i,s=0){return!(i==="Object"||s<=this.MaxDepth||this.MaxDepth<=0)}stringifyValue(t,i=0){if(t===null)return this.stringifyNull();if(t===void 0)return this.stringifyUndefined();if(typeof t=="number")return this.stringifyNumber(t);if(typeof t=="string")return this.stringifyString(t);if(typeof t=="boolean")return this.stringifyBoolean(t);if(typeof t=="function")return this.stringifyFunction(t);if(this.isCycle(t))return this.stringifyCycle();if(this.markCycle(t),Array.isArray(t)){let s=this.stringifyArray(t,i?i+1:0);return this.clearCycle(t),s}if(typeof t=="object"){let s=t.constructor.name;if(this.shouldTruncateObject(t,s,i)){let a=this.stringifyTruncatedObject(t,s,i);return this.clearCycle(t),a}else{let a=new Set,c=Object.getPrototypeOf(t),m=Object.keys(c);for(;m.length>0;)m.forEach(x=>a.add(x)),c=Object.getPrototypeOf(c),m=Object.keys(c);Object.keys(t).forEach(x=>a.add(x)),a.delete("__cycleDetection__");let p=[...a].sort().map(x=>{try{return[x,t[x]??void 0]}catch{return[x,void 0]}}).filter(([,x])=>typeof x!="function"&&x!==void 0),E=this.stringifyObject(t,s,p,i);return this.clearCycle(t),E}}return this.clearCycle(t),d.RESET+t.toString()}escapeString(t){return t.replace(/\\/g,this.EscapeColor+"\\\\"+this.StringColor).replace(/"/g,this.EscapeColor+'\\"'+this.StringColor).replace(/\n/g,this.EscapeColor+"\\n"+this.StringColor).replace(/\r/g,this.EscapeColor+"\\r"+this.StringColor).replace(/\t/g,this.EscapeColor+"\\t"+this.StringColor)}markCycle(t){t.__cycleDetection__=!0}isCycle(t){return!!t.__cycleDetection__}clearCycle(t){delete t.__cycleDetection__}},L=class I{constructor(t,i,s=d.RESET){this.level=t,this.name=i,this.color=s}static All=new I(-2,"all");static Trace=new I(-2,"trace",d.DARK_AQUA);static Debug=new I(-1,"debug",d.AQUA);static Info=new I(0,"info",d.GREEN);static Warn=new I(1,"warn",d.GOLD);static Error=new I(2,"error",d.RED);static Fatal=new I(3,"fatal",d.DARK_RED);static Off=new I(100,"off");static values=[I.All,I.Trace,I.Debug,I.Info,I.Warn,I.Error,I.Fatal,I.Off];toString(){return this.color+this.name.toUpperCase()+d.RESET}static parse(t){t=t.toLowerCase();for(let s of I.values)if(s.name===t)return s;let i=parseInt(t);if(!isNaN(i)){for(let s of I.values)if(s.level===i)return s}}};function dr(r,t){return r==="*"?!0:r.includes("*")?r.startsWith("*")?t.endsWith(r.substring(1)):r.endsWith("*")?t.startsWith(r.substring(0,r.length-1)):new RegExp(r.replace(/\*/g,".*")).test(t):r===t}var T={level:L.Info,filter:["*"],outputTags:!1,formatFunction:(r,t,i,s=void 0)=>{let a=s!==void 0?`\xA77${s.map(c=>`[${c}]`).join("")}\xA7r`:"";return`[${r}][${d.MATERIAL_EMERALD}${t.name}${d.RESET}]${a} ${i}`},messagesJoinFunction:r=>r.join(" "),jsonFormatter:yr.DEFAULT,outputConfig:{[L.Trace.level]:[0,1],[L.Debug.level]:[0,1],[L.Info.level]:[0,1],[L.Warn.level]:[0,1,2],[L.Error.level]:[0,1,3],[L.Fatal.level]:[0,1,3]}},v=class X{constructor(t,i=[]){this.name=t,this.tags=i}static initialized=!1;static init(){X.initialized||(X.initialized=!0,mr.afterEvents.scriptEventReceive.subscribe(t=>{if(t.id==="logging:level"||t.id==="log:level")if(!t.message)T.level=L.Info,tt.sendMessage(`${d.AQUA}Logging level set to ${d.BOLD}${T.level}`);else{let i=L.parse(t.message);i?(T.level=i,tt.sendMessage(`${d.AQUA}Logging level set to ${d.BOLD}${T.level}`)):tt.sendMessage(`${d.DARK_RED}Invalid logging level: ${t.message}`)}else(t.id==="logging:filter"||t.id==="log:filter")&&(t.message?T.filter=t.message.split(","):T.filter=["*"],tt.sendMessage(`${d.AQUA}Logging filter set to ${d.BOLD}${T.filter.join(", ")}`))}))}static setLevel(t){T.level=t}static setFilter(t){T.filter=t}static setFormatFunction(t){T.formatFunction=t}static setMessagesJoinFunction(t){T.messagesJoinFunction=t}static setTagsOutputVisibility(t){T.outputTags=t}static setJsonFormatter(t){T.jsonFormatter=t}static getOutputConfig(){return T.outputConfig}static getLogger(t,...i){return X.initialized||X.init(),new X(t,i)}log(t,...i){if(!(t.level<T.level.level)){if(T.filter.length===0||this.tags.length===0){this.logRaw(t,...i);return}for(let s of T.filter)if(dr(s,this.name)){this.logRaw(t,...i);return}}}logRaw(t,...i){{let s=i.map(m=>m===void 0?d.GOLD+"undefined"+d.RESET:m===null?d.GOLD+"null"+d.RESET:m&&m instanceof Error?`${d.DARK_RED}${d.BOLD}${m.message}
${d.RESET}${d.GRAY}${d.ITALIC}${m.stack}${d.RESET}`:typeof m=="object"||Array.isArray(m)?T.jsonFormatter.stringify(m)+d.RESET:m.toString()+d.RESET),a=T.formatFunction(t,this,T.messagesJoinFunction(s),T.outputTags?this.tags:void 0),c=T.outputConfig[t.level]||[0,1];c.includes(0)&&tt.sendMessage(a),c.includes(1)&&(console.originalLog?console.originalLog(d.stripColor(a)):console.log(d.stripColor(a))),c.includes(2)&&console.warn(a),c.includes(3)&&console.error(a)}}trace(...t){this.log(L.Trace,...t)}debug(...t){this.log(L.Debug,...t)}info(...t){this.log(L.Info,...t)}warn(...t){this.log(L.Warn,...t)}error(...t){this.log(L.Error,...t)}fatal(...t){this.log(L.Fatal,...t)}},kr=class h{static log=v.getLogger("vec3","vec3","bedrock-boost");static Zero=new h(0,0,0);static Down=new h(R.Down);static Up=new h(R.Up);static North=new h(R.North);static South=new h(R.South);static East=new h(R.East);static West=new h(R.West);x;y;z;constructor(t,i,s){if(t===R.Down)this.x=0,this.y=-1,this.z=0;else if(t===R.Up)this.x=0,this.y=1,this.z=0;else if(t===R.North)this.x=0,this.y=0,this.z=1;else if(t===R.South)this.x=0,this.y=0,this.z=-1;else if(t===R.East)this.x=1,this.y=0,this.z=0;else if(t===R.West)this.x=-1,this.y=0,this.z=0;else if(typeof t=="number")this.x=t,this.y=i,this.z=s;else if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2];else if(t instanceof h)this.x=t.x,this.y=t.y,this.z=t.z;else{if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid vector"),t),new Error("Invalid vector");this.x=t.x,this.y=t.y,this.z=t.z}}static from(t,i,s){if(t instanceof h)return t;if(typeof t=="number"&&i!==void 0&&s!==void 0)return new h(t,i,s);if(Array.isArray(t))return new h(t);if(t===R.Down)return h.Down;if(t===R.Up)return h.Up;if(t===R.North)return h.North;if(t===R.South)return h.South;if(t===R.East)return h.East;if(t===R.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,i,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}static _from(t,i,s){if(t instanceof h)return t;if(typeof t=="number"&&i!==void 0&&s!==void 0)return new h(t,i,s);if(Array.isArray(t))return new h(t);if(t===R.Down)return h.Down;if(t===R.Up)return h.Up;if(t===R.North)return h.North;if(t===R.South)return h.South;if(t===R.East)return h.East;if(t===R.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,i,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}copy(){return h.from(this)}static fromYawPitch(t,i){let s;typeof t=="number"?(s=t,i=i):(s=t.y,i=t.x);let a=s*(Math.PI/180),c=i*(Math.PI/180),m=Math.cos(c)*Math.sin(a),g=Math.sin(c),p=Math.cos(c)*Math.cos(a);return new h(m,g,p)}toYawPitch(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),i=Math.atan2(t.x,t.z)*(180/Math.PI);return{x:Math.asin(t.y)*(180/Math.PI),y:i}}add(t,i,s){let a=h._from(t,i,s);return h.from(a.x+this.x,a.y+this.y,a.z+this.z)}subtract(t,i,s){let a=h._from(t,i,s);return h.from(this.x-a.x,this.y-a.y,this.z-a.z)}multiply(t,i,s){if(typeof t=="number"&&i===void 0&&s===void 0)return h.from(this.x*t,this.y*t,this.z*t);let a=h._from(t,i,s);return h.from(a.x*this.x,a.y*this.y,a.z*this.z)}scale(t){return h.from(this.x*t,this.y*t,this.z*t)}divide(t,i,s){if(typeof t=="number"&&i===void 0&&s===void 0){if(t===0)throw new Error("Cannot divide by zero");return h.from(this.x/t,this.y/t,this.z/t)}let a=h._from(t,i,s);if(a.x===0||a.y===0||a.z===0)throw new Error("Cannot divide by zero");return h.from(this.x/a.x,this.y/a.y,this.z/a.z)}normalize(){if(this.isZero())throw h.log.error(new Error("Cannot normalize zero-length vector")),new Error("Cannot normalize zero-length vector");let t=this.length();return h.from(this.x/t,this.y/t,this.z/t)}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}cross(t,i,s){let a=h._from(t,i,s);return h.from(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)}distance(t,i,s){let a=h._from(t,i,s);return Math.sqrt(this.distanceSquared(a))}distanceSquared(t,i,s){let a=h._from(t,i,s);return this.subtract(a).lengthSquared()}lerp(t,i){return!t||!i?h.from(this):i===1?h.from(t):i===0?h.from(this):h.from(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i,this.z+(t.z-this.z)*i)}slerp(t,i){if(!t||!i)return h.from(this);if(i===1)return h.from(t);if(i===0)return h.from(this);let s=this.dot(t),a=Math.acos(s)*i,c=h.from(t).subtract(this.multiply(s)).normalize();return this.multiply(Math.cos(a)).add(c.multiply(Math.sin(a)))}dot(t,i,s){let a=h._from(t,i,s);return this.x*a.x+this.y*a.y+this.z*a.z}angleBetween(t,i,s){let a=h._from(t,i,s),c=this.dot(a),m=this.length()*a.length();return m===0?0:Math.acos(c/m)}projectOnto(t,i,s){let a=h._from(t,i,s);if(a.isZero())return h.Zero;let c=this.dot(a)/a.dot(a);return h.from(a.x*c,a.y*c,a.z*c)}reflect(t,i,s){let a=h._from(t,i,s),c=this.projectOnto(a);return this.subtract(c.multiply(2))}rotate(t,i){let s=i*Math.PI/180/2,a=Math.cos(s),c=t.x*Math.sin(s),m=t.y*Math.sin(s),g=t.z*Math.sin(s),p=this,E=a*a*p.x+2*m*a*p.z-2*g*a*p.y+c*c*p.x+2*m*c*p.y+2*g*c*p.z-g*g*p.x-m*m*p.x,x=2*c*m*p.x+m*m*p.y+2*g*m*p.z+2*a*g*p.x-g*g*p.y+a*a*p.y-2*c*a*p.z-c*c*p.y,b=2*c*g*p.x+2*m*g*p.y+g*g*p.z-2*a*m*p.x-m*m*p.z+2*a*c*p.y-c*c*p.z+a*a*p.z;return new h(E,x,b)}setX(t){return new h(t,this.y,this.z)}setY(t){return new h(this.x,t,this.z)}setZ(t){return new h(this.x,this.y,t)}distanceToLineSegment(t,i){let s=h.from(i).subtract(t);if(s.lengthSquared()===0)return this.subtract(t).length();let a=Math.max(0,Math.min(1,this.subtract(t).dot(s)/s.dot(s))),c=h.from(t).add(s.multiply(a));return this.subtract(c).length()}floor(){return new h(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}floorX(){return new h(Math.floor(this.x),this.y,this.z)}floorY(){return new h(this.x,Math.floor(this.y),this.z)}floorZ(){return new h(this.x,this.y,Math.floor(this.z))}ceil(){return new h(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}ceilX(){return new h(Math.ceil(this.x),this.y,this.z)}ceilY(){return new h(this.x,Math.ceil(this.y),this.z)}ceilZ(){return new h(this.x,this.y,Math.ceil(this.z))}round(){return new h(Math.round(this.x),Math.round(this.y),Math.round(this.z))}roundX(){return new h(Math.round(this.x),this.y,this.z)}roundY(){return new h(this.x,Math.round(this.y),this.z)}roundZ(){return new h(this.x,this.y,Math.round(this.z))}up(){return this.add(h.Up)}down(){return this.add(h.Down)}north(){return this.add(h.North)}south(){return this.add(h.South)}east(){return this.add(h.East)}west(){return this.add(h.West)}isZero(){return this.x===0&&this.y===0&&this.z===0}toArray(){return[this.x,this.y,this.z]}toDirection(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),i=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z));if(i===t.x)return R.East;if(i===-t.x)return R.West;if(i===t.y)return R.Up;if(i===-t.y)return R.Down;if(i===t.z)return R.North;if(i===-t.z)return R.South;throw h.log.error(new Error("Cannot convert vector to direction"),this),new Error("Cannot convert vector to direction")}toBlockLocation(){return h.from((this.x<<0)-(this.x<0&&this.x!==this.x<<0?1:0),(this.y<<0)-(this.y<0&&this.y!==this.y<<0?1:0),(this.z<<0)-(this.z<0&&this.z!==this.z<<0?1:0))}almostEqual(t,i,s,a){try{let c;return typeof t!="number"&&s===void 0?(c=h._from(t,void 0,void 0),a=i):c=h._from(t,i,s),Math.abs(this.x-c.x)<=a&&Math.abs(this.y-c.y)<=a&&Math.abs(this.z-c.z)<=a}catch{return!1}}equals(t,i,s){try{let a=h._from(t,i,s);return this.x===a.x&&this.y===a.y&&this.z===a.z}catch{return!1}}toString(t="long",i=", "){let s=`${this.x+i+this.y+i+this.z}`;return t==="long"?`Vec3(${s})`:s}},Ur=class rr{static log=v.getLogger("Timings","timings");static lastTime=-1;static lastOperation="";static begin(t){this.end(),this.lastTime=new Date().getTime(),this.lastOperation=t}static end(){let t=new Date().getTime();this.lastTime>0&&rr.log.debug(`Operation ${this.lastOperation} took ${t-this.lastTime}ms`),this.lastTime=-1}};var pr=v.getLogger("jobUtils","bedrock-boost","jobUtils");function er(r){return new Promise((t,i)=>{if(Kt.runJob)Kt.runJob(function*(){for(;;)try{let{done:s,value:a}=r.next();if(s){t(a);return}else yield}catch(s){i(s);return}}());else{pr.warn("system.runJob is not available. Running job in an inefficient way.");let s=()=>{let a=Date.now();for(;;)try{let{done:c,value:m}=r.next();if(c){t(m);return}else if(Date.now()-a>4){Kt.runTimeout(s,1);return}}catch(c){i(c);return}};s()}})}var Xr=v.getLogger("itemUtils","bedrock-boost","itemUtils");var gr=class at{static log=v.getLogger("PulseScheduler","bedrock-boost","pulse-scheduler");items=[];period;currentTick=0;runId;nextIndex=0;executionSchedule=[];processor;constructor(t,i){if(i<=0)throw new Error("Period must be a positive integer.");if(!t||typeof t!="function")throw new Error("Processor function must be defined.");this.period=i,this.processor=t}add(t){this.push(t)}addAll(t){this.push(...t)}remove(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),t<this.nextIndex&&this.nextIndex--,this.recalculateExecutionSchedule())}removeIf(t){for(let i=this.items.length-1;i>=0;i--)t(this.items[i])&&this.remove(i)}getItems(){return this.items}start(){this.stop(),this.currentTick=0,this.nextIndex=0,this.runId=_t.runInterval(()=>this.tick(),1)}stop(){this.runId!==void 0&&(_t.clearRun(this.runId),this.runId=void 0)}recalculateExecutionSchedule(){let t=this.items.length;if(this.executionSchedule=new Array(this.period).fill(0),t===0)return;let i=this.period/t;for(let s=0;s<t;s++)this.executionSchedule[Math.round(i*s)%this.period]++}tick(){if(this.items.length===0){at.log.trace("No items to process.");return}let t=this.executionSchedule[this.currentTick];if(t===0){at.log.trace("No items to process this tick."),this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0);return}let i=0;for(;this.nextIndex<this.items.length&&i<t;this.nextIndex++){try{this.processor(this.items[this.nextIndex])}catch(s){at.log.error("Error processing item",s)}i++}this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0)}push(...t){return this.items.push(...t),this.recalculateExecutionSchedule(),this.items.length}pop(){let t=this.items.pop();return this.recalculateExecutionSchedule(),t}shift(){let t=this.items.shift();return this.recalculateExecutionSchedule(),t}unshift(...t){return this.items.unshift(...t),this.recalculateExecutionSchedule(),this.items.length}splice(t,i=0,...s){let a=this.items.splice(t,i,...s);return this.recalculateExecutionSchedule(),a}};var ee=class Ht extends gr{static logger=v.getLogger("PlayerPulseScheduler","bedrock-boost","player-pulse-scheduler");constructor(t,i){super(s=>{s.isValid()?t(s):this.removeIf(a=>!a.isValid())},i),this.push(...st.getAllPlayers())}compareEntities(t,i){return t.id===i.id}start(){st.afterEvents.playerJoin.subscribe(t=>{let i=0,s=()=>{if(i++,i>10){Ht.logger.warn("Failed to push player to scheduler after 10 attempts.");return}try{let a=st.getEntity(t.playerId);a===void 0&&Vt.runTimeout(s,1),a instanceof xr&&this.push(a)}catch(a){Ht.logger.debug("Failed to push player to scheduler.",a),Vt.runTimeout(s,1)}};s()}),st.afterEvents.playerLeave.subscribe(t=>{this.removeIf(i=>!i.isValid()||i.id===t.playerId)}),super.start()}push(...t){let i=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.push(...i)}unshift(...t){let i=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.unshift(...i)}splice(t,i,...s){if(i===void 0)return super.splice(t);let a=s.filter(c=>!this.items.some(m=>this.compareEntities(m,c)));return super.splice(t,i,...a)}};function Zt(r){er(r()).then(()=>Zt(r))}var nr="sunbeam:weather";Yt.afterEvents.weatherChange.subscribe(r=>{Yt.setDynamicProperty(nr,r.newWeather)});function ut(){return Yt.getDynamicProperty(nr)??Mr.Clear}var Er=["minecraft:leather_helmet","minecraft:iron_helmet","minecraft:golden_helmet","minecraft:diamond_helmet","minecraft:netherite_helmet","minecraft:turtle_helmet","minecraft:chainmail_helmet"];function ir(r){for(let t of Er){let i=`testfor @s[hasitem={location=slot.armor.head,item=${t}}]`;if(r.runCommand(i).successCount===1)return!0}return!1}function or(r){let t=Math.cos(r.azimuth),i=Math.sin(r.azimuth),s=$.from([t,0,i,0,1,0,-i,0,t]),a=Math.cos(r.zenith),c=Math.sin(r.zenith),m=$.from([1,0,0,0,a,-c,0,c,a]);return $.mul(s,m)}function Qt(r,t,i){let s=w.dot(r,w.neg(t));return i*i*(1-s*s)>1?w.reflect(r,t):w.refract(r,t,i)}var Jt;(c=>(c.Default={azimuth:0,zenith:Math.PI/4},c.Infectious={azimuth:.6,zenith:.951},c.Interstellar={azimuth:.813,zenith:.667},c.Seraphic={azimuth:3.5841,zenith:.785398},c.Vanilla={azimuth:0,zenith:0}))(Jt||={});var wr=or(Jt.Default);function Ar(r,t,i){return Math.min(Math.max(r,t),i)}function br(){let r=(zr.getTimeOfDay()+1e3)%24e3;return Ar(r/14e3,0,1)}function ht(){let r=Math.PI*br(),t=w.rotate(w.East,w.South,r);return $.mul(wr,t)}var W="sunbeam";function sr(r){let t=r.sourceEntity,i="";switch(r.id){case`${W}:help`:switch(r.message){case"dts":i=`\xA7edts:
Logs the current direction to sun vector.
\xA7rUsage:
 - /scriptevent ${W}:dts`;break;case"wet":i=`\xA7ewet:
Logs the currently stored weather value.
\xA7rUsage:
 - /scriptevent ${W}:wet`;break;default:i=`\xA72--- Showing help page 1 of 1 ---
\xA7r/scriptevent ${W}:help [command: CommandName]
/scriptevent ${W}:dts
/scriptevent ${W}:wet`}break;case`${W}:dts`:i=`Direction to Sun: {${w.toString(ht())}}`;break;case`${W}:wet`:i=`Get weather result: ${ut()}`;break}t.sendMessage(i)}import{system as Lr}from"@minecraft/server";import{EntityComponentTypes as Rr,EntityInitializationCause as Sr,MinecraftDimensionTypes as Tr,WeatherType as Ir,world as lt}from"@minecraft/server";var ct=lt.getDimension(Tr.overworld),Cr=.001;function Xt(r){return(r==null?void 0:r.typeId.includes("glass"))??!1}function ar(r,t,i){let s=ct.getBlockFromRay(r,t,i);if(s===void 0||!Xt(s.block))return s;let a;try{a=ct.getBlock(r)}catch{}let c=Xt(a);r=w.add(s.block.location,s.faceLocation,w.mul(t,Cr));let m;try{m=ct.getBlock(r)}catch{}let g=Xt(m);if(!c&&g){let p=w.fromDirection(s.face);t=Qt(t,p,1/1.5)}else if(c&&!g){let p=w.neg(w.fromDirection(s.face));t=Qt(t,p,1.5/1)}else if(!c&&!g)return s;return ar(r,t,i)}function ft(r){let t=ht();return ar(r,t,{includeLiquidBlocks:!0})===void 0}function Dr(r){return r.hasComponent(Rr.OnFire)}function*ur(){if(!((lt.getTimeOfDay()+540)%24e3>=13082)&&ut()===Ir.Clear)for(let r of ct.getEntities({families:["sunbeam_burn"]})){if(!r||!r.isValid()||r.isInWater||Dr(r)||ir(r))continue;let t=r.location,i=r.getHeadLocation();(ft(t)||ft(i))&&r.setOnFire(8,!0),yield}}lt.afterEvents.entitySpawn.subscribe(r=>{if((lt.getTimeOfDay()+540)%24e3>=13082)return;let{cause:t,entity:i}=r;if(t!==Sr.Spawned||!i.matches({families:["sunbeam_burn"]}))return;let s=i.location,a=i.getHeadLocation();(ft(s)||ft(a))&&i.remove()});Lr.afterEvents.scriptEventReceive.subscribe(sr);Zt(ur);
//# sourceMappingURL=main.js.map