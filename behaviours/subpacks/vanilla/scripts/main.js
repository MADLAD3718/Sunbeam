import{world as xr}from"@minecraft/server";import{Direction as j}from"@minecraft/server";var w;(r=>{r.Zero={x:0,y:0,z:0},r.One={x:1,y:1,z:1},r.Up={x:0,y:1,z:0},r.Down={x:0,y:-1,z:0},r.North={x:0,y:0,z:-1},r.South={x:0,y:0,z:1},r.East={x:1,y:0,z:0},r.West={x:-1,y:0,z:0},r.X=r.East,r.Y=r.Up,r.Z=r.South;function t(e){return typeof e=="object"&&"x"in e&&"y"in e&&"z"in e}r.isVector3=t;function o(e,u,x){if(typeof e=="number")return{x:e,y:u??e,z:x??e};if(Array.isArray(e)&&e.length>=3)return{x:e[0],y:e[1],z:e[2]};throw new Error("Invalid input values for vector construction.")}r.from=o;function s(e){switch(e){case"up":return r.Up;case"down":return r.Down;case"north":return r.North;case"south":return r.South;case"east":return r.East;case"west":return r.West}throw new Error("Argument was not of type 'block_face' or 'cardinal_direction'.")}r.fromBlockFace=s;function a(e){return m(e).toLowerCase()}r.toBlockFace=a;function c(e){switch(e){case j.Up:return r.Up;case j.Down:return r.Down;case j.North:return r.North;case j.South:return r.South;case j.East:return r.East;case j.West:return r.West}}r.fromDirection=c;function m(e){let u=it(e),x=et(e),D=Math.max(u.x,u.y,u.z);return D===u.x?x.x>=0?j.East:j.West:D===u.y?x.y>=0?j.Up:j.Down:x.z>=0?j.South:j.North}r.toDirection=m;function g(e){return{x:-p(Math.asin(e.y)),y:-p(Math.atan2(e.x,e.z))}}r.toRotation=g;function p(e){return 180*e/Math.PI}function M(e){let{x:u,y:x,z:D}=e;return[u,x,D]}r.toArray=M;function z(e){return M(e).join(" ")}r.toString=z;function R(e){let[u,x,D]=e.split(" ").map(Number);return{x:u,y:x,z:D}}r.parse=R;function L(e){return Number.isNaN(e.x)||Number.isNaN(e.y)||Number.isNaN(e.z)}r.isnan=L;function U(e){return!y(e)}r.isinf=U;function y(e){return Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)}r.isfinite=y;function S(e,u){return e.x===u.x&&e.y===u.y&&e.z===u.z}r.equal=S;function v(e,u){return{x:Math.min(e.x,u.x),y:Math.min(e.y,u.y),z:Math.min(e.z,u.z)}}r.min=v;function n(e,u){return{x:Math.max(e.x,u.x),y:Math.max(e.y,u.y),z:Math.max(e.z,u.z)}}r.max=n;function E(e,u,x){return{x:Math.min(Math.max(e.x,u.x),x.x),y:Math.min(Math.max(e.y,u.y),x.y),z:Math.min(Math.max(e.z,u.z),x.z)}}r.clamp=E;function k(e){return{x:Math.min(Math.max(e.x,0),1),y:Math.min(Math.max(e.y,0),1),z:Math.min(Math.max(e.z,0),1)}}r.saturate=k;function et(e){return{x:Math.sign(e.x),y:Math.sign(e.y),z:Math.sign(e.z)}}r.sign=et;function ft(e){return{x:Math.floor(e.x),y:Math.floor(e.y),z:Math.floor(e.z)}}r.floor=ft;function _(e){return{x:Math.ceil(e.x),y:Math.ceil(e.y),z:Math.ceil(e.z)}}r.ceil=_;function Z(e){return{x:e.x-Math.floor(e.x),y:e.y-Math.floor(e.y),z:e.z-Math.floor(e.z)}}r.frac=Z;function F(e){return{x:Math.round(e.x),y:Math.round(e.y),z:Math.round(e.z)}}r.round=F;function nt(e,u){return{x:e.x%u.x,y:e.y%u.y,z:e.z%u.z}}r.mod=nt;function mt(e){return{x:-e.x,y:-e.y,z:-e.z}}r.neg=mt;function it(e){return{x:Math.abs(e.x),y:Math.abs(e.y),z:Math.abs(e.z)}}r.abs=it;function N(e,...u){for(let x of u)e={x:e.x+x.x,y:e.y+x.y,z:e.z+x.z};return e}r.add=N;function K(e,...u){for(let x of u)e={x:e.x-x.x,y:e.y-x.y,z:e.z-x.z};return e}r.sub=K;function I(e,u){return t(u)?{x:e.x*u.x,y:e.y*u.y,z:e.z*u.z}:{x:e.x*u,y:e.y*u,z:e.z*u}}r.mul=I;function ot(e,u){return t(u)?{x:e.x/u.x,y:e.y/u.y,z:e.z/u.z}:{x:e.x/u,y:e.y/u,z:e.z/u}}r.div=ot;function yt(e){return{x:Math.sqrt(e.x),y:Math.sqrt(e.y),z:Math.sqrt(e.z)}}r.sqrt=yt;function dt(e){return{x:Math.exp(e.x),y:Math.exp(e.y),z:Math.exp(e.z)}}r.exp=dt;function pt(e){return{x:Math.pow(2,e.x),y:Math.pow(2,e.y),z:Math.pow(2,e.z)}}r.exp2=pt;function gt(e){return{x:Math.log(e.x),y:Math.log(e.y),z:Math.log(e.z)}}r.log=gt;function xt(e){return{x:Math.log2(e.x),y:Math.log2(e.y),z:Math.log2(e.z)}}r.log2=xt;function Mt(e){return{x:Math.log10(e.x),y:Math.log10(e.y),z:Math.log10(e.z)}}r.log10=Mt;function Et(e,u){return t(u)?{x:Math.pow(e.x,u.x),y:Math.pow(e.y,u.y),z:Math.pow(e.z,u.z)}:{x:Math.pow(e.x,u),y:Math.pow(e.y,u),z:Math.pow(e.z,u)}}r.pow=Et;function zt(e){return{x:Math.sin(e.x),y:Math.sin(e.y),z:Math.sin(e.z)}}r.sin=zt;function wt(e){return{x:Math.asin(e.x),y:Math.asin(e.y),z:Math.asin(e.z)}}r.asin=wt;function At(e){return{x:Math.sinh(e.x),y:Math.sinh(e.y),z:Math.sinh(e.z)}}r.sinh=At;function bt(e){return{x:Math.asinh(e.x),y:Math.asinh(e.y),z:Math.asinh(e.z)}}r.asinh=bt;function Rt(e){return{x:Math.cos(e.x),y:Math.cos(e.y),z:Math.cos(e.z)}}r.cos=Rt;function St(e){return{x:Math.acos(e.x),y:Math.acos(e.y),z:Math.acos(e.z)}}r.acos=St;function $(e){return{x:Math.cosh(e.x),y:Math.cosh(e.y),z:Math.cosh(e.z)}}r.cosh=$;function Tt(e){return{x:Math.acosh(e.x),y:Math.acosh(e.y),z:Math.acosh(e.z)}}r.acosh=Tt;function V(e){return{x:Math.tan(e.x),y:Math.tan(e.y),z:Math.tan(e.z)}}r.tan=V;function Ct(e){return{x:Math.atan(e.x),y:Math.atan(e.y),z:Math.atan(e.z)}}r.atan=Ct;function It(e){return{x:Math.tanh(e.x),y:Math.tanh(e.y),z:Math.tanh(e.z)}}r.tanh=It;function st(e){return{x:Math.atanh(e.x),y:Math.atanh(e.y),z:Math.atanh(e.z)}}r.atanh=st;function Dt(e,u=1){return N(e,I(r.Up,u))}r.above=Dt;function Lt(e,u=1){return N(e,I(r.Down,u))}r.below=Lt;function Ot(e,u=1){return N(e,I(r.North,u))}r.north=Ot;function Nt(e,u=1){return N(e,I(r.South,u))}r.south=Nt;function Pt(e,u=1){return N(e,I(r.East,u))}r.east=Pt;function jt(e,u=1){return N(e,I(r.West,u))}r.west=jt;function i(e,u){return e.x*u.x+e.y*u.y+e.z*u.z}r.dot=i;function f(e,u){return{x:e.y*u.z-e.z*u.y,y:e.z*u.x-e.x*u.z,z:e.x*u.y-e.y*u.x}}r.cross=f;function A(e){return Math.hypot(e.x,e.y,e.z)}r.length=A;function P(e){return ot(e,A(e))}r.normalize=P;function B(e,u){return A(K(e,u))}r.distance=B;function H(e,u){return I(u,i(e,u)/i(u,u))}r.project=H;function Ut(e,u){return K(e,H(e,u))}r.reject=Ut;function kt(e,u){return K(e,I(u,2*i(u,e)))}r.reflect=kt;function sr(e,u,x){let D=-i(e,u),Q=x*x*(1-D*D),Y=Math.sqrt(1-Q);return N(I(e,x),I(u,x*D-Y))}r.refract=sr;function ar(e,u,x){return x===0?e:x===1?u:{x:e.x+x*(u.x-e.x),y:e.y+x*(u.y-e.y),z:e.z+x*(u.z-e.z)}}r.lerp=ar;function ur(e,u,x){if(x===0)return e;if(x===1)return u;let D=i(e,u),Q=Math.acos(D),Y=Math.sqrt(1-D*D),qt=Math.sin((1-x)*Q)/Y,Ft=Math.sin(x*Q)/Y;return N(I(e,qt),I(u,Ft))}r.slerp=ur;function hr(e,u,x){let D=Math.cos(x),Q=Math.sin(x),Y=I(u,i(e,u)),qt=K(e,Y),Ft=f(u,e);return N(Y,N(I(qt,D),I(Ft,Q)))}r.rotate=hr})(w||(w={}));var G;(r=>{r.Identity={m11:1,m12:0,m13:0,m21:0,m22:1,m23:0,m31:0,m32:0,m33:1};function t(n){return typeof n=="object"&&"m11"in n&&"m12"in n&&"m13"in n&&"m21"in n&&"m22"in n&&"m23"in n&&"m31"in n&&"m32"in n&&"m33"in n}r.isMatrix3=t;function o(n,E,k){if(Array.isArray(n)&&n.length>=9)return{m11:n[0],m12:n[1],m13:n[2],m21:n[3],m22:n[4],m23:n[5],m31:n[6],m32:n[7],m33:n[8]};if(w.isVector3(n)&&E&&k)return{m11:n.x,m12:E.x,m13:k.x,m21:n.y,m22:E.y,m23:k.y,m31:n.z,m32:E.z,m33:k.z};throw new Error("Invalid input values for vector construction.")}r.from=o;function s(n){return{x:n.m11,y:n.m21,z:n.m31}}r.c1=s;function a(n){return{x:n.m12,y:n.m22,z:n.m32}}r.c2=a;function c(n){return{x:n.m13,y:n.m23,z:n.m33}}r.c3=c;function m(n){return{x:n.m11,y:n.m12,z:n.m13}}r.r1=m;function g(n){return{x:n.m21,y:n.m22,z:n.m23}}r.r2=g;function p(n){return{x:n.m31,y:n.m32,z:n.m33}}r.r3=p;function M(n,E){return t(E)?{m11:w.dot(m(n),s(E)),m12:w.dot(m(n),a(E)),m13:w.dot(m(n),c(E)),m21:w.dot(g(n),s(E)),m22:w.dot(g(n),a(E)),m23:w.dot(g(n),c(E)),m31:w.dot(p(n),s(E)),m32:w.dot(p(n),a(E)),m33:w.dot(p(n),c(E))}:w.isVector3(E)?{x:w.dot(m(n),E),y:w.dot(g(n),E),z:w.dot(p(n),E)}:{m11:n.m11*E,m12:n.m12*E,m13:n.m13*E,m21:n.m21*E,m22:n.m22*E,m23:n.m23*E,m31:n.m31*E,m32:n.m32*E,m33:n.m33*E}}r.mul=M;function z(n){return n.m11+n.m22+n.m33}r.trace=z;function R(n){return n.m11*n.m22*n.m33+n.m21*n.m32*n.m13+n.m31*n.m12*n.m23-n.m13*n.m22*n.m31-n.m23*n.m32*n.m11-n.m33*n.m12*n.m21}r.determinant=R;function L(n){return{m11:n.m11,m12:n.m21,m13:n.m31,m21:n.m12,m22:n.m22,m23:n.m32,m31:n.m13,m32:n.m23,m33:n.m33}}r.transpose=L;function U(n){return{m11:n.m22*n.m33-n.m23*n.m32,m12:n.m23*n.m31-n.m21*n.m33,m13:n.m21*n.m32-n.m22*n.m31,m21:n.m13*n.m32-n.m12*n.m33,m22:n.m11*n.m33-n.m13*n.m31,m23:n.m12*n.m31-n.m11*n.m32,m31:n.m12*n.m23-n.m13*n.m22,m32:n.m13*n.m21-n.m11*n.m23,m33:n.m11*n.m22-n.m12*n.m21}}r.cofactor=U;function y(n){return{m11:n.m22*n.m33-n.m23*n.m32,m12:n.m13*n.m32-n.m12*n.m33,m13:n.m12*n.m23-n.m13*n.m22,m21:n.m23*n.m31-n.m21*n.m33,m22:n.m11*n.m33-n.m13*n.m31,m23:n.m13*n.m21-n.m11*n.m23,m31:n.m21*n.m32-n.m22*n.m31,m32:n.m12*n.m31-n.m11*n.m32,m33:n.m11*n.m22-n.m12*n.m21}}r.adjugate=y;function S(n){let E=R(n);if(E===0)throw new Error("Matrix is not invertible.");return M(y(n),1/E)}r.inverse=S;function v(n){let E=Math.abs(n.y)===1?w.East:w.normalize(w.from(n.z,0,-n.x)),k=w.cross(E,n);return r.from(E,n,k)}r.buildTNB=v})(G||(G={}));var at;(r=>{r.Identity={m11:1,m12:0,m21:0,m22:1};function t(y){return typeof y=="object"&&"m11"in y&&"m12"in y&&"m21"in y&&"m22"in y}r.isMatrix2=t;function o(y,S){if(Array.isArray(y)&&y.length>=4)return{m11:y[0],m12:y[1],m21:y[2],m22:y[3]};if(q.isVector2(y)&&S)return{m11:y.x,m12:S.x,m21:y.y,m22:S.y};throw new Error("Invalid input values for vector construction.")}r.from=o;function s(y){return{x:y.m11,y:y.m21}}r.c1=s;function a(y){return{x:y.m12,y:y.m22}}r.c2=a;function c(y){return{x:y.m11,y:y.m12}}r.r1=c;function m(y){return{x:y.m21,y:y.m22}}r.r2=m;function g(y,S){return t(S)?{m11:q.dot(c(y),s(S)),m12:q.dot(c(y),a(S)),m21:q.dot(m(y),s(S)),m22:q.dot(m(y),a(S))}:q.isVector2(S)?{x:q.dot(c(y),S),y:q.dot(m(y),S)}:{m11:y.m11*S,m12:y.m12*S,m21:y.m21*S,m22:y.m22*S}}r.mul=g;function p(y){return y.m11+y.m22}r.trace=p;function M(y){return y.m11*y.m22-y.m12*y.m21}r.determinant=M;function z(y){return{m11:y.m11,m12:y.m21,m21:y.m12,m22:y.m22}}r.transpose=z;function R(y){return{m11:y.m22,m12:-y.m21,m21:-y.m12,m22:y.m11}}r.cofactor=R;function L(y){return{m11:y.m22,m12:-y.m12,m21:-y.m21,m22:y.m11}}r.adjugate=L;function U(y){let S=M(y);if(S===0)throw new Error("Matrix is not invertible.");return g(L(y),1/S)}r.inverse=U})(at||(at={}));var q;(r=>{r.Zero={x:0,y:0},r.One={x:1,y:1},r.Up={x:0,y:1},r.Down={x:0,y:-1},r.Left={x:-1,y:0},r.Right={x:1,y:0},r.X=r.Right,r.Y=r.Up;function t(i){return typeof i=="object"&&"x"in i&&"y"in i}r.isVector2=t;function o(i,f){if(Array.isArray(i)&&i.length>=2)return{x:i[0],y:i[1]};if(typeof i=="number")return{x:i,y:f??i};throw new Error("Invalid input values for vector construction.")}r.from=o;function s(i){let{x:f,y:A}=i;return[f,A]}r.toArray=s;function a(i){return s(i).join(" ")}r.toString=a;function c(i){let[f,A]=i.split(" ").map(Number);return{x:f,y:A}}r.parse=c;function m(i){return Number.isNaN(i.x)||Number.isNaN(i.y)}r.isnan=m;function g(i){return!p(i)}r.isinf=g;function p(i){return Number.isFinite(i.x)&&Number.isFinite(i.y)}r.isfinite=p;function M(i,f){return i.x===f.x&&i.y===f.y}r.equal=M;function z(i,f){return{x:Math.min(i.x,f.x),y:Math.min(i.y,f.y)}}r.min=z;function R(i,f){return{x:Math.max(i.x,f.x),y:Math.max(i.y,f.y)}}r.max=R;function L(i,f,A){return{x:Math.min(Math.max(i.x,f.x),A.x),y:Math.min(Math.max(i.y,f.y),A.y)}}r.clamp=L;function U(i){return{x:Math.min(Math.max(i.x,0),1),y:Math.min(Math.max(i.y,0),1)}}r.saturate=U;function y(i){return{x:Math.sign(i.x),y:Math.sign(i.y)}}r.sign=y;function S(i){return{x:Math.floor(i.x),y:Math.floor(i.y)}}r.floor=S;function v(i){return{x:Math.ceil(i.x),y:Math.ceil(i.y)}}r.ceil=v;function n(i){return{x:i.x-Math.floor(i.x),y:i.y-Math.floor(i.y)}}r.frac=n;function E(i){return{x:Math.round(i.x),y:Math.round(i.y)}}r.round=E;function k(i,f){return{x:i.x%f.x,y:i.y%f.y}}r.mod=k;function et(i){return{x:-i.x,y:-i.y}}r.neg=et;function ft(i){return{x:Math.abs(i.x),y:Math.abs(i.y)}}r.abs=ft;function _(i,...f){for(let A of f)i={x:i.x+A.x,y:i.y+A.y};return i}r.add=_;function Z(i,...f){for(let A of f)i={x:i.x-A.x,y:i.y-A.y};return i}r.sub=Z;function F(i,f){return t(f)?{x:i.x*f.x,y:i.y*f.y}:{x:i.x*f,y:i.y*f}}r.mul=F;function nt(i,f){return t(f)?{x:i.x/f.x,y:i.y/f.y}:{x:i.x/f,y:i.y/f}}r.div=nt;function mt(i){return{x:Math.sqrt(i.x),y:Math.sqrt(i.y)}}r.sqrt=mt;function it(i){return{x:Math.exp(i.x),y:Math.exp(i.y)}}r.exp=it;function N(i){return{x:Math.pow(2,i.x),y:Math.pow(2,i.y)}}r.exp2=N;function K(i){return{x:Math.log(i.x),y:Math.log(i.y)}}r.log=K;function I(i){return{x:Math.log2(i.x),y:Math.log2(i.y)}}r.log2=I;function ot(i){return{x:Math.log10(i.x),y:Math.log10(i.y)}}r.log10=ot;function yt(i,f){return t(f)?{x:Math.pow(i.x,f.x),y:Math.pow(i.y,f.y)}:{x:Math.pow(i.x,f),y:Math.pow(i.y,f)}}r.pow=yt;function dt(i){return{x:Math.sin(i.x),y:Math.sin(i.y)}}r.sin=dt;function pt(i){return{x:Math.asin(i.x),y:Math.asin(i.y)}}r.asin=pt;function gt(i){return{x:Math.sinh(i.x),y:Math.sinh(i.y)}}r.sinh=gt;function xt(i){return{x:Math.asinh(i.x),y:Math.asinh(i.y)}}r.asinh=xt;function Mt(i){return{x:Math.cos(i.x),y:Math.cos(i.y)}}r.cos=Mt;function Et(i){return{x:Math.acos(i.x),y:Math.acos(i.y)}}r.acos=Et;function zt(i){return{x:Math.cosh(i.x),y:Math.cosh(i.y)}}r.cosh=zt;function wt(i){return{x:Math.acosh(i.x),y:Math.acosh(i.y)}}r.acosh=wt;function At(i){return{x:Math.tan(i.x),y:Math.tan(i.y)}}r.tan=At;function bt(i){return{x:Math.atan(i.x),y:Math.atan(i.y)}}r.atan=bt;function Rt(i){return{x:Math.tanh(i.x),y:Math.tanh(i.y)}}r.tanh=Rt;function St(i){return{x:Math.atanh(i.x),y:Math.atanh(i.y)}}r.atanh=St;function $(i,f){return i.x*f.x+i.y*f.y}r.dot=$;function Tt(i,f){return i.x*f.y-i.y*f.x}r.wedge=Tt;function V(i){return Math.hypot(i.x,i.y)}r.length=V;function Ct(i){return nt(i,V(i))}r.normalize=Ct;function It(i,f){return V(Z(i,f))}r.distance=It;function st(i,f){return F(f,$(i,f)/$(f,f))}r.project=st;function Dt(i,f){return Z(i,st(i,f))}r.reject=Dt;function Lt(i,f){return Z(i,F(f,2*$(f,i)))}r.reflect=Lt;function Ot(i,f,A){let P=-$(i,f),B=A*A*(1-P*P),H=Math.sqrt(1-B);return _(F(i,A),F(f,A*P-H))}r.refract=Ot;function Nt(i,f,A){return A===0?i:A===1?f:{x:i.x+A*(f.x-i.x),y:i.y+A*(f.y-i.y)}}r.lerp=Nt;function Pt(i,f,A){if(A===0)return i;if(A===1)return f;let P=$(i,f),B=Math.acos(P),H=Math.sqrt(1-P*P),Ut=Math.sin((1-A)*B)/H,kt=Math.sin(A*B)/H;return _(F(i,Ut),F(f,kt))}r.slerp=Pt;function jt(i,f){let A=Math.cos(f),P=Math.sin(f),B=at.from([A,-P,P,A]);return at.mul(B,i)}r.rotate=jt})(q||(q={}));var Qt;(r=>{function t(){return{x:Math.random(),y:Math.random()}}r.random2=t;function o(){return{x:Math.random(),y:Math.random(),z:Math.random()}}r.random3=o;function s(){let M=Math.random()*Math.PI*2;return{x:Math.cos(M),y:Math.sin(M)}}r.circle=s;function a(){let M=t(),z=M.x*Math.PI*2,R=Math.sqrt(M.y);return{x:R*Math.cos(z),y:R*Math.sin(z)}}r.disk=a;function c(){let M=t(),z=M.x*Math.PI*2,R=2*Math.sqrt(M.y*(1-M.y));return{x:Math.cos(z)*R,y:1-2*M.y,z:Math.sin(z)*R}}r.sphere=c;function m(){let M=t(),z=M.x*Math.PI*2,R=Math.sqrt(M.y*(2-M.y));return{x:Math.cos(z)*R,y:1-M.y,z:Math.sin(z)*R}}r.hemisphere=m;function g(){let M=t(),z=M.x*Math.PI*2,R=Math.sqrt(M.y);return{x:Math.cos(z)*R,y:Math.sqrt(1-M.y),z:Math.sin(z)*R}}r.cosHemisphere=g;function p(M){let z=t(),R=z.x*Math.PI*2,L=z.y*(1-Math.cos(M)),U=Math.sqrt(L*(2-L));return{x:Math.cos(R)*U,y:1-L,z:Math.sin(R)*U}}r.cap=p})(Qt||(Qt={}));import{WeatherType as pr,world as Gt}from"@minecraft/server";import{Direction as b}from"@minecraft/server";import{system as cr,world as tt}from"@minecraft/server";import{system as Ur}from"@minecraft/server";import{BlockPermutation as qr,world as Fr}from"@minecraft/server";import{world as Br}from"@minecraft/server";import{Player as Wr}from"@minecraft/server";import{system as $t}from"@minecraft/server";import{EquipmentSlot as Yr}from"@minecraft/server";import{system as Jt}from"@minecraft/server";import{MinecraftDimensionTypes as Xr,world as vr}from"@minecraft/server";import{Player as dr,system as Xt,world as ut}from"@minecraft/server";var d=class l{constructor(t,o){this.code=t,this.color=o,o&&(this.r=o>>16&255,this.g=o>>8&255,this.b=o&255)}static BLACK=new l("0",0);static DARK_BLUE=new l("1",170);static DARK_GREEN=new l("2",43520);static DARK_AQUA=new l("3",43690);static DARK_RED=new l("4",11141120);static DARK_PURPLE=new l("5",11141290);static GOLD=new l("6",16755200);static GRAY=new l("7",11184810);static DARK_GRAY=new l("8",5592405);static BLUE=new l("9",5592575);static GREEN=new l("a",5635925);static AQUA=new l("b",5636095);static RED=new l("c",16733525);static LIGHT_PURPLE=new l("d",16733695);static YELLOW=new l("e",16777045);static WHITE=new l("f",16777215);static MINECOIN_GOLD=new l("g",14603781);static MATERIAL_QUARTZ=new l("h",14931153);static MATERIAL_IRON=new l("i",13552330);static MATERIAL_NETHERITE=new l("j",4471355);static MATERIAL_REDSTONE=new l("m",9901575);static MATERIAL_COPPER=new l("n",11823181);static MATERIAL_GOLD=new l("p",14594349);static MATERIAL_EMERALD=new l("q",1155126);static MATERIAL_DIAMOND=new l("s",2931368);static MATERIAL_LAPIS=new l("t",2181499);static MATERIAL_AMETHYST=new l("u",10116294);static OBFUSCATED=new l("k");static BOLD=new l("l");static ITALIC=new l("o");static RESET=new l("r");static VALUES=[l.BLACK,l.DARK_BLUE,l.DARK_GREEN,l.DARK_AQUA,l.DARK_RED,l.DARK_PURPLE,l.GOLD,l.GRAY,l.DARK_GRAY,l.BLUE,l.GREEN,l.AQUA,l.RED,l.LIGHT_PURPLE,l.YELLOW,l.WHITE,l.MINECOIN_GOLD,l.MATERIAL_QUARTZ,l.MATERIAL_IRON,l.MATERIAL_NETHERITE,l.MATERIAL_REDSTONE,l.MATERIAL_COPPER,l.MATERIAL_GOLD,l.MATERIAL_EMERALD,l.MATERIAL_DIAMOND,l.MATERIAL_LAPIS,l.MATERIAL_AMETHYST,l.OBFUSCATED,l.BOLD,l.ITALIC,l.RESET];static ALL_COLORS=[l.BLACK,l.DARK_BLUE,l.DARK_GREEN,l.DARK_AQUA,l.DARK_RED,l.DARK_PURPLE,l.GOLD,l.GRAY,l.DARK_GRAY,l.BLUE,l.GREEN,l.AQUA,l.RED,l.LIGHT_PURPLE,l.YELLOW,l.WHITE,l.MINECOIN_GOLD,l.MATERIAL_QUARTZ,l.MATERIAL_IRON,l.MATERIAL_NETHERITE,l.MATERIAL_REDSTONE,l.MATERIAL_COPPER,l.MATERIAL_GOLD,l.MATERIAL_EMERALD,l.MATERIAL_DIAMOND,l.MATERIAL_LAPIS,l.MATERIAL_AMETHYST];r;g;b;static PREFIX="\xA7";toString(){return l.PREFIX+this.code}toRGB(){return this.color}toHex(){var t;return(t=this.color)==null?void 0:t.toString(16)}getRed(){return this.r}getGreen(){return this.g}getBlue(){return this.b}getCode(){return this.code}static stripColor(t){return t.replace(/ยง[0-9a-u]/g,"")}static findClosestColor(t,o,s){let a=Number.MAX_VALUE,c=l.WHITE;for(let m of l.ALL_COLORS)if(m.r&&m.g&&m.b){let g=Math.sqrt(Math.pow(m.r-t,2)+Math.pow(m.g-o,2)+Math.pow(m.b-s,2));g<a&&(a=g,c=m)}return c}},lr=class vt{OpenObject="{";CloseObject="}";OpenArray="[";CloseArray="]";Comma=",";KeyValueSeparator=":";StringDelimiter='"';KeyDelimiter="";Indent="  ";NewLine=`
`;Space=" ";InlineThreshold=60;MaxDepth=1;IncludeClassNames=!0;FunctionValue="\u0192";NullValue="null";UndefinedValue="undefined";TrueValue="true";FalseValue="false";CycleValue="[...cycle...]";TruncatedObjectValue="{...}";OpenCloseObjectColor=d.YELLOW;OpenCloseArrayColor=d.AQUA;NumberColor=d.DARK_AQUA;StringColor=d.DARK_GREEN;BooleanColor=d.GOLD;NullColor=d.GOLD;KeyColor=d.GRAY;EscapeColor=d.GOLD;FunctionColor=d.GRAY;ClassColor=d.GRAY;ClassStyle=d.BOLD;CycleColor=d.DARK_RED;static DEFAULT=new vt;stringify(t){return this.stringifyValue(t)}stringifyString(t){return this.StringColor+this.StringDelimiter+this.escapeString(t)+this.StringDelimiter+d.RESET}stringifyNumber(t){return this.NumberColor+t.toString()+d.RESET}stringifyBoolean(t){return this.BooleanColor+(t?this.TrueValue:this.FalseValue)+d.RESET}stringifyFunction(t){return this.FunctionColor+this.FunctionValue+d.RESET}stringifyNull(){return this.NullColor+this.NullValue+d.RESET}stringifyUndefined(){return this.NullColor+this.UndefinedValue+d.RESET}stringifyCycle(){return this.CycleColor+this.CycleValue+d.RESET}stringifyArray(t,o=0){let s=this.Indent.repeat(o);if(t.length===0)return this.OpenCloseArrayColor+this.OpenArray+this.CloseArray+d.RESET;let a=this.OpenCloseArrayColor+this.OpenArray+d.RESET+this.NewLine,c=this.OpenCloseArrayColor+this.OpenArray+d.RESET;return t.forEach((m,g)=>{a+=s+this.Indent+this.stringifyValue(m,o+1),a+=g<t.length-1?this.Comma+this.NewLine:this.NewLine,c+=this.stringifyValue(m,o+1),c+=g<t.length-1?this.Comma+this.Space:""}),a+=s+this.OpenCloseArrayColor+this.CloseArray+d.RESET,c+=this.OpenCloseArrayColor+this.CloseArray+d.RESET,c.length<this.InlineThreshold?c:a}stringifyTruncatedObject(t,o,s=0){return(this.IncludeClassNames?this.ClassColor+""+this.ClassStyle+o+d.RESET+this.Space:"")+this.TruncatedObjectValue}stringifyObject(t,o,s,a=0){let c=this.Indent.repeat(a),m=this.IncludeClassNames&&o!=="Object"?this.ClassColor+""+this.ClassStyle+o+d.RESET+this.Space:"";if(s.length===0)return m+this.OpenCloseObjectColor+this.OpenObject+this.CloseObject+d.RESET;let g=m+this.OpenCloseObjectColor+this.OpenObject+d.RESET+this.NewLine,p=m+this.OpenCloseObjectColor+this.OpenObject+d.RESET;return s.forEach(([M,z],R)=>{let L=this.stringifyValue(z,a+1);g+=c+this.Indent+this.KeyColor+this.KeyDelimiter+M+this.KeyDelimiter+d.RESET+this.KeyValueSeparator+this.Space+L,g+=R<s.length-1?this.Comma+this.NewLine:this.NewLine,p+=this.KeyColor+M+d.RESET+this.KeyValueSeparator+this.Space+L,p+=R<s.length-1?this.Comma+this.Space:""}),g+=c+this.OpenCloseObjectColor+this.CloseObject+d.RESET,p+=this.OpenCloseObjectColor+this.CloseObject+d.RESET,p.length<this.InlineThreshold?p:g}shouldTruncateObject(t,o,s=0){return!(o==="Object"||s<=this.MaxDepth||this.MaxDepth<=0)}stringifyValue(t,o=0){if(t===null)return this.stringifyNull();if(t===void 0)return this.stringifyUndefined();if(typeof t=="number")return this.stringifyNumber(t);if(typeof t=="string")return this.stringifyString(t);if(typeof t=="boolean")return this.stringifyBoolean(t);if(typeof t=="function")return this.stringifyFunction(t);if(this.isCycle(t))return this.stringifyCycle();if(this.markCycle(t),Array.isArray(t)){let s=this.stringifyArray(t,o?o+1:0);return this.clearCycle(t),s}if(typeof t=="object"){let s=t.constructor.name;if(this.shouldTruncateObject(t,s,o)){let a=this.stringifyTruncatedObject(t,s,o);return this.clearCycle(t),a}else{let a=new Set,c=Object.getPrototypeOf(t),m=Object.keys(c);for(;m.length>0;)m.forEach(z=>a.add(z)),c=Object.getPrototypeOf(c),m=Object.keys(c);Object.keys(t).forEach(z=>a.add(z)),a.delete("__cycleDetection__");let p=[...a].sort().map(z=>{try{return[z,t[z]??void 0]}catch{return[z,void 0]}}).filter(([,z])=>typeof z!="function"&&z!==void 0),M=this.stringifyObject(t,s,p,o);return this.clearCycle(t),M}}return this.clearCycle(t),d.RESET+t.toString()}escapeString(t){return t.replace(/\\/g,this.EscapeColor+"\\\\"+this.StringColor).replace(/"/g,this.EscapeColor+'\\"'+this.StringColor).replace(/\n/g,this.EscapeColor+"\\n"+this.StringColor).replace(/\r/g,this.EscapeColor+"\\r"+this.StringColor).replace(/\t/g,this.EscapeColor+"\\t"+this.StringColor)}markCycle(t){t.__cycleDetection__=!0}isCycle(t){return!!t.__cycleDetection__}clearCycle(t){delete t.__cycleDetection__}},O=class C{constructor(t,o,s=d.RESET){this.level=t,this.name=o,this.color=s}static All=new C(-2,"all");static Trace=new C(-2,"trace",d.DARK_AQUA);static Debug=new C(-1,"debug",d.AQUA);static Info=new C(0,"info",d.GREEN);static Warn=new C(1,"warn",d.GOLD);static Error=new C(2,"error",d.RED);static Fatal=new C(3,"fatal",d.DARK_RED);static Off=new C(100,"off");static values=[C.All,C.Trace,C.Debug,C.Info,C.Warn,C.Error,C.Fatal,C.Off];toString(){return this.color+this.name.toUpperCase()+d.RESET}static parse(t){t=t.toLowerCase();for(let s of C.values)if(s.name===t)return s;let o=parseInt(t);if(!isNaN(o)){for(let s of C.values)if(s.level===o)return s}}};function fr(r,t){return r==="*"?!0:r.includes("*")?r.startsWith("*")?t.endsWith(r.substring(1)):r.endsWith("*")?t.startsWith(r.substring(0,r.length-1)):new RegExp(r.replace(/\*/g,".*")).test(t):r===t}var T={level:O.Info,filter:["*"],outputTags:!1,formatFunction:(r,t,o,s=void 0)=>{let a=s!==void 0?`\xA77${s.map(c=>`[${c}]`).join("")}\xA7r`:"";return`[${r}][${d.MATERIAL_EMERALD}${t.name}${d.RESET}]${a} ${o}`},messagesJoinFunction:r=>r.join(" "),jsonFormatter:lr.DEFAULT,outputConfig:{[O.Trace.level]:[0,1],[O.Debug.level]:[0,1],[O.Info.level]:[0,1],[O.Warn.level]:[0,1,2],[O.Error.level]:[0,1,3],[O.Fatal.level]:[0,1,3]}},X=class J{constructor(t,o=[]){this.name=t,this.tags=o}static initialized=!1;static init(){J.initialized||(J.initialized=!0,cr.afterEvents.scriptEventReceive.subscribe(t=>{if(t.id==="logging:level"||t.id==="log:level")if(!t.message)T.level=O.Info,tt.sendMessage(`${d.AQUA}Logging level set to ${d.BOLD}${T.level}`);else{let o=O.parse(t.message);o?(T.level=o,tt.sendMessage(`${d.AQUA}Logging level set to ${d.BOLD}${T.level}`)):tt.sendMessage(`${d.DARK_RED}Invalid logging level: ${t.message}`)}else(t.id==="logging:filter"||t.id==="log:filter")&&(t.message?T.filter=t.message.split(","):T.filter=["*"],tt.sendMessage(`${d.AQUA}Logging filter set to ${d.BOLD}${T.filter.join(", ")}`))}))}static setLevel(t){T.level=t}static setFilter(t){T.filter=t}static setFormatFunction(t){T.formatFunction=t}static setMessagesJoinFunction(t){T.messagesJoinFunction=t}static setTagsOutputVisibility(t){T.outputTags=t}static setJsonFormatter(t){T.jsonFormatter=t}static getOutputConfig(){return T.outputConfig}static getLogger(t,...o){return J.initialized||J.init(),new J(t,o)}log(t,...o){if(!(t.level<T.level.level)){if(T.filter.length===0||this.tags.length===0){this.logRaw(t,...o);return}for(let s of T.filter)if(fr(s,this.name)){this.logRaw(t,...o);return}}}logRaw(t,...o){{let s=o.map(m=>m===void 0?d.GOLD+"undefined"+d.RESET:m===null?d.GOLD+"null"+d.RESET:m&&m instanceof Error?`${d.DARK_RED}${d.BOLD}${m.message}
${d.RESET}${d.GRAY}${d.ITALIC}${m.stack}${d.RESET}`:typeof m=="object"||Array.isArray(m)?T.jsonFormatter.stringify(m)+d.RESET:m.toString()+d.RESET),a=T.formatFunction(t,this,T.messagesJoinFunction(s),T.outputTags?this.tags:void 0),c=T.outputConfig[t.level]||[0,1];c.includes(0)&&tt.sendMessage(a),c.includes(1)&&(console.originalLog?console.originalLog(d.stripColor(a)):console.log(d.stripColor(a))),c.includes(2)&&console.warn(a),c.includes(3)&&console.error(a)}}trace(...t){this.log(O.Trace,...t)}debug(...t){this.log(O.Debug,...t)}info(...t){this.log(O.Info,...t)}warn(...t){this.log(O.Warn,...t)}error(...t){this.log(O.Error,...t)}fatal(...t){this.log(O.Fatal,...t)}},Nr=class h{static log=X.getLogger("vec3","vec3","bedrock-boost");static Zero=new h(0,0,0);static Down=new h(b.Down);static Up=new h(b.Up);static North=new h(b.North);static South=new h(b.South);static East=new h(b.East);static West=new h(b.West);x;y;z;constructor(t,o,s){if(t===b.Down)this.x=0,this.y=-1,this.z=0;else if(t===b.Up)this.x=0,this.y=1,this.z=0;else if(t===b.North)this.x=0,this.y=0,this.z=1;else if(t===b.South)this.x=0,this.y=0,this.z=-1;else if(t===b.East)this.x=1,this.y=0,this.z=0;else if(t===b.West)this.x=-1,this.y=0,this.z=0;else if(typeof t=="number")this.x=t,this.y=o,this.z=s;else if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2];else if(t instanceof h)this.x=t.x,this.y=t.y,this.z=t.z;else{if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid vector"),t),new Error("Invalid vector");this.x=t.x,this.y=t.y,this.z=t.z}}static from(t,o,s){if(t instanceof h)return t;if(typeof t=="number"&&o!==void 0&&s!==void 0)return new h(t,o,s);if(Array.isArray(t))return new h(t);if(t===b.Down)return h.Down;if(t===b.Up)return h.Up;if(t===b.North)return h.North;if(t===b.South)return h.South;if(t===b.East)return h.East;if(t===b.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,o,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}static _from(t,o,s){if(t instanceof h)return t;if(typeof t=="number"&&o!==void 0&&s!==void 0)return new h(t,o,s);if(Array.isArray(t))return new h(t);if(t===b.Down)return h.Down;if(t===b.Up)return h.Up;if(t===b.North)return h.North;if(t===b.South)return h.South;if(t===b.East)return h.East;if(t===b.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,o,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}copy(){return h.from(this)}static fromYawPitch(t,o){let s;typeof t=="number"?(s=t,o=o):(s=t.y,o=t.x);let a=s*(Math.PI/180),c=o*(Math.PI/180),m=Math.cos(c)*Math.sin(a),g=Math.sin(c),p=Math.cos(c)*Math.cos(a);return new h(m,g,p)}toYawPitch(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),o=Math.atan2(t.x,t.z)*(180/Math.PI);return{x:Math.asin(t.y)*(180/Math.PI),y:o}}add(t,o,s){let a=h._from(t,o,s);return h.from(a.x+this.x,a.y+this.y,a.z+this.z)}subtract(t,o,s){let a=h._from(t,o,s);return h.from(this.x-a.x,this.y-a.y,this.z-a.z)}multiply(t,o,s){if(typeof t=="number"&&o===void 0&&s===void 0)return h.from(this.x*t,this.y*t,this.z*t);let a=h._from(t,o,s);return h.from(a.x*this.x,a.y*this.y,a.z*this.z)}scale(t){return h.from(this.x*t,this.y*t,this.z*t)}divide(t,o,s){if(typeof t=="number"&&o===void 0&&s===void 0){if(t===0)throw new Error("Cannot divide by zero");return h.from(this.x/t,this.y/t,this.z/t)}let a=h._from(t,o,s);if(a.x===0||a.y===0||a.z===0)throw new Error("Cannot divide by zero");return h.from(this.x/a.x,this.y/a.y,this.z/a.z)}normalize(){if(this.isZero())throw h.log.error(new Error("Cannot normalize zero-length vector")),new Error("Cannot normalize zero-length vector");let t=this.length();return h.from(this.x/t,this.y/t,this.z/t)}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}cross(t,o,s){let a=h._from(t,o,s);return h.from(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)}distance(t,o,s){let a=h._from(t,o,s);return Math.sqrt(this.distanceSquared(a))}distanceSquared(t,o,s){let a=h._from(t,o,s);return this.subtract(a).lengthSquared()}lerp(t,o){return!t||!o?h.from(this):o===1?h.from(t):o===0?h.from(this):h.from(this.x+(t.x-this.x)*o,this.y+(t.y-this.y)*o,this.z+(t.z-this.z)*o)}slerp(t,o){if(!t||!o)return h.from(this);if(o===1)return h.from(t);if(o===0)return h.from(this);let s=this.dot(t),a=Math.acos(s)*o,c=h.from(t).subtract(this.multiply(s)).normalize();return this.multiply(Math.cos(a)).add(c.multiply(Math.sin(a)))}dot(t,o,s){let a=h._from(t,o,s);return this.x*a.x+this.y*a.y+this.z*a.z}angleBetween(t,o,s){let a=h._from(t,o,s),c=this.dot(a),m=this.length()*a.length();return m===0?0:Math.acos(c/m)}projectOnto(t,o,s){let a=h._from(t,o,s);if(a.isZero())return h.Zero;let c=this.dot(a)/a.dot(a);return h.from(a.x*c,a.y*c,a.z*c)}reflect(t,o,s){let a=h._from(t,o,s),c=this.projectOnto(a);return this.subtract(c.multiply(2))}rotate(t,o){let s=o*Math.PI/180/2,a=Math.cos(s),c=t.x*Math.sin(s),m=t.y*Math.sin(s),g=t.z*Math.sin(s),p=this,M=a*a*p.x+2*m*a*p.z-2*g*a*p.y+c*c*p.x+2*m*c*p.y+2*g*c*p.z-g*g*p.x-m*m*p.x,z=2*c*m*p.x+m*m*p.y+2*g*m*p.z+2*a*g*p.x-g*g*p.y+a*a*p.y-2*c*a*p.z-c*c*p.y,R=2*c*g*p.x+2*m*g*p.y+g*g*p.z-2*a*m*p.x-m*m*p.z+2*a*c*p.y-c*c*p.z+a*a*p.z;return new h(M,z,R)}setX(t){return new h(t,this.y,this.z)}setY(t){return new h(this.x,t,this.z)}setZ(t){return new h(this.x,this.y,t)}distanceToLineSegment(t,o){let s=h.from(o).subtract(t);if(s.lengthSquared()===0)return this.subtract(t).length();let a=Math.max(0,Math.min(1,this.subtract(t).dot(s)/s.dot(s))),c=h.from(t).add(s.multiply(a));return this.subtract(c).length()}floor(){return new h(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}floorX(){return new h(Math.floor(this.x),this.y,this.z)}floorY(){return new h(this.x,Math.floor(this.y),this.z)}floorZ(){return new h(this.x,this.y,Math.floor(this.z))}ceil(){return new h(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}ceilX(){return new h(Math.ceil(this.x),this.y,this.z)}ceilY(){return new h(this.x,Math.ceil(this.y),this.z)}ceilZ(){return new h(this.x,this.y,Math.ceil(this.z))}round(){return new h(Math.round(this.x),Math.round(this.y),Math.round(this.z))}roundX(){return new h(Math.round(this.x),this.y,this.z)}roundY(){return new h(this.x,Math.round(this.y),this.z)}roundZ(){return new h(this.x,this.y,Math.round(this.z))}up(){return this.add(h.Up)}down(){return this.add(h.Down)}north(){return this.add(h.North)}south(){return this.add(h.South)}east(){return this.add(h.East)}west(){return this.add(h.West)}isZero(){return this.x===0&&this.y===0&&this.z===0}toArray(){return[this.x,this.y,this.z]}toDirection(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),o=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z));if(o===t.x)return b.East;if(o===-t.x)return b.West;if(o===t.y)return b.Up;if(o===-t.y)return b.Down;if(o===t.z)return b.North;if(o===-t.z)return b.South;throw h.log.error(new Error("Cannot convert vector to direction"),this),new Error("Cannot convert vector to direction")}toBlockLocation(){return h.from((this.x<<0)-(this.x<0&&this.x!==this.x<<0?1:0),(this.y<<0)-(this.y<0&&this.y!==this.y<<0?1:0),(this.z<<0)-(this.z<0&&this.z!==this.z<<0?1:0))}almostEqual(t,o,s,a){try{let c;return typeof t!="number"&&s===void 0?(c=h._from(t,void 0,void 0),a=o):c=h._from(t,o,s),Math.abs(this.x-c.x)<=a&&Math.abs(this.y-c.y)<=a&&Math.abs(this.z-c.z)<=a}catch{return!1}}equals(t,o,s){try{let a=h._from(t,o,s);return this.x===a.x&&this.y===a.y&&this.z===a.z}catch{return!1}}toString(t="long",o=", "){let s=`${this.x+o+this.y+o+this.z}`;return t==="long"?`Vec3(${s})`:s}},Pr=class _t{static log=X.getLogger("Timings","timings");static lastTime=-1;static lastOperation="";static begin(t){this.end(),this.lastTime=new Date().getTime(),this.lastOperation=t}static end(){let t=new Date().getTime();this.lastTime>0&&_t.log.debug(`Operation ${this.lastOperation} took ${t-this.lastTime}ms`),this.lastTime=-1}};var mr=X.getLogger("jobUtils","bedrock-boost","jobUtils");function Vt(r){return new Promise((t,o)=>{if($t.runJob)$t.runJob(function*(){for(;;)try{let{done:s,value:a}=r.next();if(s){t(a);return}else yield}catch(s){o(s);return}}());else{mr.warn("system.runJob is not available. Running job in an inefficient way.");let s=()=>{let a=Date.now();for(;;)try{let{done:c,value:m}=r.next();if(c){t(m);return}else if(Date.now()-a>4){$t.runTimeout(s,1);return}}catch(c){o(c);return}};s()}})}var Zr=X.getLogger("itemUtils","bedrock-boost","itemUtils");var yr=class ht{static log=X.getLogger("PulseScheduler","bedrock-boost","pulse-scheduler");items=[];period;currentTick=0;runId;nextIndex=0;executionSchedule=[];processor;constructor(t,o){if(o<=0)throw new Error("Period must be a positive integer.");if(!t||typeof t!="function")throw new Error("Processor function must be defined.");this.period=o,this.processor=t}add(t){this.push(t)}addAll(t){this.push(...t)}remove(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),t<this.nextIndex&&this.nextIndex--,this.recalculateExecutionSchedule())}removeIf(t){for(let o=this.items.length-1;o>=0;o--)t(this.items[o])&&this.remove(o)}getItems(){return this.items}start(){this.stop(),this.currentTick=0,this.nextIndex=0,this.runId=Jt.runInterval(()=>this.tick(),1)}stop(){this.runId!==void 0&&(Jt.clearRun(this.runId),this.runId=void 0)}recalculateExecutionSchedule(){let t=this.items.length;if(this.executionSchedule=new Array(this.period).fill(0),t===0)return;let o=this.period/t;for(let s=0;s<t;s++)this.executionSchedule[Math.round(o*s)%this.period]++}tick(){if(this.items.length===0){ht.log.trace("No items to process.");return}let t=this.executionSchedule[this.currentTick];if(t===0){ht.log.trace("No items to process this tick."),this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0);return}let o=0;for(;this.nextIndex<this.items.length&&o<t;this.nextIndex++){try{this.processor(this.items[this.nextIndex])}catch(s){ht.log.error("Error processing item",s)}o++}this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0)}push(...t){return this.items.push(...t),this.recalculateExecutionSchedule(),this.items.length}pop(){let t=this.items.pop();return this.recalculateExecutionSchedule(),t}shift(){let t=this.items.shift();return this.recalculateExecutionSchedule(),t}unshift(...t){return this.items.unshift(...t),this.recalculateExecutionSchedule(),this.items.length}splice(t,o=0,...s){let a=this.items.splice(t,o,...s);return this.recalculateExecutionSchedule(),a}};var Vr=class Bt extends yr{static logger=X.getLogger("PlayerPulseScheduler","bedrock-boost","player-pulse-scheduler");constructor(t,o){super(s=>{s.isValid()?t(s):this.removeIf(a=>!a.isValid())},o),this.push(...ut.getAllPlayers())}compareEntities(t,o){return t.id===o.id}start(){ut.afterEvents.playerJoin.subscribe(t=>{let o=0,s=()=>{if(o++,o>10){Bt.logger.warn("Failed to push player to scheduler after 10 attempts.");return}try{let a=ut.getEntity(t.playerId);a===void 0&&Xt.runTimeout(s,1),a instanceof dr&&this.push(a)}catch(a){Bt.logger.debug("Failed to push player to scheduler.",a),Xt.runTimeout(s,1)}};s()}),ut.afterEvents.playerLeave.subscribe(t=>{this.removeIf(o=>!o.isValid()||o.id===t.playerId)}),super.start()}push(...t){let o=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.push(...o)}unshift(...t){let o=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.unshift(...o)}splice(t,o,...s){if(o===void 0)return super.splice(t);let a=s.filter(c=>!this.items.some(m=>this.compareEntities(m,c)));return super.splice(t,o,...a)}};function Wt(r){Vt(r()).then(()=>Wt(r))}var tr="sunbeam:weather";Gt.afterEvents.weatherChange.subscribe(r=>{r.dimension==="overworld"&&Gt.setDynamicProperty(tr,r.newWeather)});function ct(){return Gt.getDynamicProperty(tr)??pr.Clear}var gr=["minecraft:leather_helmet","minecraft:iron_helmet","minecraft:golden_helmet","minecraft:diamond_helmet","minecraft:netherite_helmet","minecraft:turtle_helmet","minecraft:chainmail_helmet"];function rr(r){for(let t of gr){let o=`testfor @s[hasitem={location=slot.armor.head,item=${t}}]`;if(r.runCommand(o).successCount===1)return!0}return!1}function er(r){let t=Math.cos(r.azimuth),o=Math.sin(r.azimuth),s=G.from([t,0,o,0,1,0,-o,0,t]),a=Math.cos(r.zenith),c=Math.sin(r.zenith),m=G.from([1,0,0,0,a,-c,0,c,a]);return G.mul(s,m)}function Kt(r,t,o){let s=w.dot(r,w.neg(t));return s*s<1-1/(o*o)?w.reflect(r,t):w.refract(r,t,o)}var Ht;(c=>(c.Default={azimuth:0,zenith:Math.PI/4},c.Infectious={azimuth:.6,zenith:.951},c.Interstellar={azimuth:.813,zenith:.667},c.Seraphic={azimuth:3.5841,zenith:.785398},c.Vanilla={azimuth:0,zenith:0}))(Ht||={});var Mr=er(Ht.Vanilla);function Er(r,t,o){return Math.min(Math.max(r,t),o)}function zr(){let r=(xr.getTimeOfDay()+1e3)%24e3;return Er(r/14e3,0,1)}function lt(){let r=Math.PI*zr(),t=w.rotate(w.East,w.South,r);return G.mul(Mr,t)}var W="sunbeam";function nr(r){let t=r.sourceEntity,o="";switch(r.id){case`${W}:help`:switch(r.message){case"dts":o=`\xA7edts:
Logs the current direction to sun vector.
\xA7rUsage:
 - /scriptevent ${W}:dts`;break;case"wet":o=`\xA7ewt:
Logs the currently stored weather value.
\xA7rUsage:
 - /scriptevent ${W}:wet`;break;default:o=`\xA72--- Showing help page 1 of 1 ---
\xA7r/scriptevent ${W}:help [command: CommandName]
/scriptevent ${W}:dts
/scriptevent ${W}:wet`}break;case`${W}:dts`:o=`Direction to Sun: {${w.toString(lt())}}`;break;case`${W}:wet`:o=`Get weather result: ${ct()}`;break}t.sendMessage(o)}import{system as Cr}from"@minecraft/server";import{EntityComponentTypes as wr,MinecraftDimensionTypes as Ar,WeatherType as br,world as ir}from"@minecraft/server";var rt=ir.getDimension(Ar.overworld),Rr=1e-5;function Yt(r){return(r==null?void 0:r.typeId.includes("glass"))??!1}function Zt(r,t,o){let s=rt.getBlockFromRay(r,t,o);if(s===void 0||!Yt(s.block))return s;let a=Yt(rt.getBlock(r))??!1;r=w.add(s.block.location,s.faceLocation,w.mul(t,Rr));let c=Yt(rt.getBlock(r))??!1;if(!a&&c){let m=w.fromDirection(s.face);t=Kt(t,m,1/1.5)}else if(a&&!c){let m=w.neg(w.fromDirection(s.face));t=Kt(t,m,1.5/1)}else if(!a&&!c)return s;return Zt(r,t,o)}function Sr(r){let t=lt(),o=r.location,s=r.getHeadLocation(),a={includeLiquidBlocks:!0};return Zt(o,t,a)===void 0||Zt(s,t,a)===void 0}function Tr(r){return r.hasComponent(wr.OnFire)}function*or(){var r;if(!((ir.getTimeOfDay()+540)%24e3>=13082)&&ct()===br.Clear)for(let t of rt.getEntities({families:["burns_in_sunlight"]}))!t||!t.isValid()||((r=rt.getBlock(t.location))==null?void 0:r.typeId)!=="minecraft:water"&&(Tr(t)||rr(t)||(Sr(t)&&t.setOnFire(8,!0),yield))}Cr.afterEvents.scriptEventReceive.subscribe(nr);Wt(or);
//# sourceMappingURL=main.js.map