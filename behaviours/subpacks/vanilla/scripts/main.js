import{world as gr}from"@minecraft/server";import{Direction as P}from"@minecraft/server";var w;(e=>{e.Zero={x:0,y:0,z:0},e.Up={x:0,y:1,z:0},e.Down={x:0,y:-1,z:0},e.North={x:0,y:0,z:-1},e.South={x:0,y:0,z:1},e.East={x:1,y:0,z:0},e.West={x:-1,y:0,z:0},e.X=e.East,e.Y=e.Up,e.Z=e.South;function t(r){return typeof r=="object"&&"x"in r&&"y"in r&&"z"in r}e.isVector3=t;function o(r,u,g){if(typeof r=="number")return{x:r,y:u??r,z:g??r};if(Array.isArray(r)&&r.length>=3)return{x:r[0],y:r[1],z:r[2]};throw new Error("Invalid input values for vector construction.")}e.from=o;function s(r){switch(r){case"up":return e.Up;case"down":return e.Down;case"north":return e.North;case"south":return e.South;case"east":return e.East;case"west":return e.West}throw new Error("Argument was not of type 'block_face' or 'cardinal_direction'.")}e.fromBlockFace=s;function a(r){return y(r).toLowerCase()}e.toBlockFace=a;function l(r){switch(r){case P.Up:return e.Up;case P.Down:return e.Down;case P.North:return e.North;case P.South:return e.South;case P.East:return e.East;case P.West:return e.West}}e.fromDirection=l;function y(r){let u=et(r),g=j(r),I=Math.max(u.x,u.y,u.z);return I===u.x?g.x>=0?P.East:P.West:I===u.y?g.y>=0?P.Up:P.Down:g.z>=0?P.South:P.North}e.toDirection=y;function z(r){function u(g){return Math.PI*g/180}return{x:Math.cos(u(r.y+90)),y:Math.cos(u(r.x+90)),z:Math.sin(u(r.y+90))}}e.fromRotation=z;function p(r){function u(g){return 180*g/Math.PI}return{x:u(Math.acos(r.y)-Math.PI/2),y:u(Math.atan2(r.z,r.x)-Math.PI/2)}}e.toRotation=p;function C(r){let{x:u,y:g,z:I}=r;return[u,g,I]}e.toArray=C;function b(r){return C(r).join(" ")}e.toString=b;function L(r){let[u,g,I]=r.split(" ").map(Number);return{x:u,y:g,z:I}}e.parse=L;function v(r){return Number.isNaN(r.x)||Number.isNaN(r.y)||Number.isNaN(r.z)}e.isnan=v;function B(r){return!d(r)}e.isinf=B;function d(r){return Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z)}e.isfinite=d;function A(r,u){return r.x===u.x&&r.y===u.y&&r.z===u.z}e.equal=A;function X(r,u){return{x:Math.min(r.x,u.x),y:Math.min(r.y,u.y),z:Math.min(r.z,u.z)}}e.min=X;function n(r,u){return{x:Math.max(r.x,u.x),y:Math.max(r.y,u.y),z:Math.max(r.z,u.z)}}e.max=n;function m(r,u,g){return{x:Math.min(Math.max(r.x,u.x),g.x),y:Math.min(Math.max(r.y,u.y),g.y),z:Math.min(Math.max(r.z,u.z),g.z)}}e.clamp=m;function j(r){return{x:Math.sign(r.x),y:Math.sign(r.y),z:Math.sign(r.z)}}e.sign=j;function lt(r){return{x:Math.floor(r.x),y:Math.floor(r.y),z:Math.floor(r.z)}}e.floor=lt;function V(r){return{x:Math.ceil(r.x),y:Math.ceil(r.y),z:Math.ceil(r.z)}}e.ceil=V;function H(r){return{x:r.x-Math.floor(r.x),y:r.y-Math.floor(r.y),z:r.z-Math.floor(r.z)}}e.frac=H;function k(r){return{x:Math.round(r.x),y:Math.round(r.y),z:Math.round(r.z)}}e.round=k;function rt(r,u){return{x:r.x%u.x,y:r.y%u.y,z:r.z%u.z}}e.mod=rt;function ft(r){return{x:-r.x,y:-r.y,z:-r.z}}e.neg=ft;function et(r){return{x:Math.abs(r.x),y:Math.abs(r.y),z:Math.abs(r.z)}}e.abs=et;function O(r,...u){for(let g of u)r={x:r.x+g.x,y:r.y+g.y,z:r.z+g.z};return r}e.add=O;function W(r,...u){for(let g of u)r={x:r.x-g.x,y:r.y-g.y,z:r.z-g.z};return r}e.sub=W;function T(r,u){return t(u)?{x:r.x*u.x,y:r.y*u.y,z:r.z*u.z}:{x:r.x*u,y:r.y*u,z:r.z*u}}e.mul=T;function nt(r,u){return t(u)?{x:r.x/u.x,y:r.y/u.y,z:r.z/u.z}:{x:r.x/u,y:r.y/u,z:r.z/u}}e.div=nt;function yt(r){return{x:Math.sqrt(r.x),y:Math.sqrt(r.y),z:Math.sqrt(r.z)}}e.sqrt=yt;function dt(r){return{x:Math.exp(r.x),y:Math.exp(r.y),z:Math.exp(r.z)}}e.exp=dt;function xt(r){return{x:Math.pow(2,r.x),y:Math.pow(2,r.y),z:Math.pow(2,r.z)}}e.exp2=xt;function pt(r){return{x:Math.log(r.x),y:Math.log(r.y),z:Math.log(r.z)}}e.log=pt;function gt(r){return{x:Math.log2(r.x),y:Math.log2(r.y),z:Math.log2(r.z)}}e.log2=gt;function zt(r){return{x:Math.log10(r.x),y:Math.log10(r.y),z:Math.log10(r.z)}}e.log10=zt;function mt(r,u){return t(u)?{x:Math.pow(r.x,u.x),y:Math.pow(r.y,u.y),z:Math.pow(r.z,u.z)}:{x:Math.pow(r.x,u),y:Math.pow(r.y,u),z:Math.pow(r.z,u)}}e.pow=mt;function wt(r){return{x:Math.sin(r.x),y:Math.sin(r.y),z:Math.sin(r.z)}}e.sin=wt;function Et(r){return{x:Math.asin(r.x),y:Math.asin(r.y),z:Math.asin(r.z)}}e.asin=Et;function Mt(r){return{x:Math.sinh(r.x),y:Math.sinh(r.y),z:Math.sinh(r.z)}}e.sinh=Mt;function At(r){return{x:Math.asinh(r.x),y:Math.asinh(r.y),z:Math.asinh(r.z)}}e.asinh=At;function bt(r){return{x:Math.cos(r.x),y:Math.cos(r.y),z:Math.cos(r.z)}}e.cos=bt;function Rt(r){return{x:Math.acos(r.x),y:Math.acos(r.y),z:Math.acos(r.z)}}e.acos=Rt;function q(r){return{x:Math.cosh(r.x),y:Math.cosh(r.y),z:Math.cosh(r.z)}}e.cosh=q;function St(r){return{x:Math.acosh(r.x),y:Math.acosh(r.y),z:Math.acosh(r.z)}}e.acosh=St;function _(r){return{x:Math.tan(r.x),y:Math.tan(r.y),z:Math.tan(r.z)}}e.tan=_;function Tt(r){return{x:Math.atan(r.x),y:Math.atan(r.y),z:Math.atan(r.z)}}e.atan=Tt;function Ct(r){return{x:Math.tanh(r.x),y:Math.tanh(r.y),z:Math.tanh(r.z)}}e.tanh=Ct;function it(r){return{x:Math.atanh(r.x),y:Math.atanh(r.y),z:Math.atanh(r.z)}}e.atanh=it;function It(r,u=1){return O(r,T(e.Up,u))}e.above=It;function Dt(r,u=1){return O(r,T(e.Down,u))}e.below=Dt;function Lt(r,u=1){return O(r,T(e.North,u))}e.north=Lt;function Ot(r,u=1){return O(r,T(e.South,u))}e.south=Ot;function Nt(r,u=1){return O(r,T(e.East,u))}e.east=Nt;function Pt(r,u=1){return O(r,T(e.West,u))}e.west=Pt;function i(r,u){return r.x*u.x+r.y*u.y+r.z*u.z}e.dot=i;function f(r,u){return{x:r.y*u.z-r.z*u.y,y:r.z*u.x-r.x*u.z,z:r.x*u.y-r.y*u.x}}e.cross=f;function E(r){return Math.hypot(r.x,r.y,r.z)}e.length=E;function N(r){return nt(r,E(r))}e.normalize=N;function F(r,u){return E(W(r,u))}e.distance=F;function K(r,u){return T(u,i(r,u)/i(u,u))}e.project=K;function vt(r,u){return W(r,K(r,u))}e.reject=vt;function jt(r,u){return W(r,T(u,2*i(u,r)))}e.reflect=jt;function or(r,u,g){let I=-i(r,u),Z=g*g*(1-I*I),Y=Math.sqrt(1-Z);return O(T(r,g),T(u,g*I-Y))}e.refract=or;function sr(r,u,g){return g===0?r:g===1?u:{x:r.x+g*(u.x-r.x),y:r.y+g*(u.y-r.y),z:r.z+g*(u.z-r.z)}}e.lerp=sr;function ar(r,u,g){if(g===0)return r;if(g===1)return u;let I=i(r,u),Z=Math.acos(I),Y=Math.sqrt(1-I*I),Ut=Math.sin((1-g)*Z)/Y,kt=Math.sin(g*Z)/Y;return O(T(r,Ut),T(u,kt))}e.slerp=ar;function ur(r,u,g){let I=Math.cos(g),Z=Math.sin(g),Y=T(u,i(r,u)),Ut=W(r,Y),kt=f(u,r);return O(Y,O(T(Ut,I),T(kt,Z)))}e.rotate=ur})(w||(w={}));var $;(e=>{e.Identity={ux:1,vx:0,wx:0,uy:0,vy:1,wy:0,uz:0,vz:0,wz:1};function t(n){return typeof n=="object"&&"ux"in n&&"vx"in n&&"wx"in n&&"uy"in n&&"vy"in n&&"wy"in n&&"uz"in n&&"vz"in n&&"wz"in n}e.isMatrix3=t;function o(n,m,j){if(Array.isArray(n)&&n.length>=9)return{ux:n[0],vx:n[1],wx:n[2],uy:n[3],vy:n[4],wy:n[5],uz:n[6],vz:n[7],wz:n[8]};if(w.isVector3(n)&&m&&j)return{ux:n.x,vx:m.x,wx:j.x,uy:n.y,vy:m.y,wy:j.y,uz:n.z,vz:m.z,wz:j.z};throw new Error("Invalid input values for vector construction.")}e.from=o;function s(n){return{x:n.ux,y:n.uy,z:n.uz}}e.c1=s;function a(n){return{x:n.vx,y:n.vy,z:n.vz}}e.c2=a;function l(n){return{x:n.wx,y:n.wy,z:n.wz}}e.c3=l;function y(n){return{x:n.ux,y:n.vx,z:n.wx}}e.r1=y;function z(n){return{x:n.uy,y:n.vy,z:n.wy}}e.r2=z;function p(n){return{x:n.uz,y:n.vz,z:n.wz}}e.r3=p;function C(n,m){return t(m)?{ux:w.dot(y(n),s(m)),vx:w.dot(y(n),a(m)),wx:w.dot(y(n),l(m)),uy:w.dot(z(n),s(m)),vy:w.dot(z(n),a(m)),wy:w.dot(z(n),l(m)),uz:w.dot(p(n),s(m)),vz:w.dot(p(n),a(m)),wz:w.dot(p(n),l(m))}:w.isVector3(m)?{x:w.dot(y(n),m),y:w.dot(z(n),m),z:w.dot(p(n),m)}:{ux:n.ux*m,vx:n.vx*m,wx:n.wx*m,uy:n.uy*m,vy:n.vy*m,wy:n.wy*m,uz:n.uz*m,vz:n.vz*m,wz:n.wz*m}}e.mul=C;function b(n){return n.ux+n.vy+n.wz}e.trace=b;function L(n){return n.ux*n.vy*n.wz+n.uy*n.vz*n.wx+n.uz*n.vx*n.wy-n.wx*n.vy*n.uz-n.wy*n.vz*n.ux-n.wz*n.vx*n.uy}e.determinant=L;function v(n){return{ux:n.ux,vx:n.uy,wx:n.uz,uy:n.vx,vy:n.vy,wy:n.vz,uz:n.wx,vz:n.wy,wz:n.wz}}e.transpose=v;function B(n){return{ux:n.vy*n.wz-n.wy*n.vz,vx:n.wy*n.uz-n.uy*n.wz,wx:n.uy*n.vz-n.vy*n.uz,uy:n.wx*n.vz-n.vx*n.wz,vy:n.ux*n.wz-n.wx*n.uz,wy:n.vx*n.uz-n.ux*n.vz,uz:n.vx*n.wy-n.wx*n.vy,vz:n.wx*n.uy-n.ux*n.wy,wz:n.ux*n.vy-n.vx*n.uy}}e.cofactor=B;function d(n){return{ux:n.vy*n.wz-n.wy*n.vz,vx:n.wx*n.vz-n.vx*n.wz,wx:n.vx*n.wy-n.wx*n.vy,uy:n.wy*n.uz-n.uy*n.wz,vy:n.ux*n.wz-n.wx*n.uz,wy:n.wx*n.uy-n.ux*n.wy,uz:n.uy*n.vz-n.vy*n.uz,vz:n.vx*n.uz-n.ux*n.vz,wz:n.ux*n.vy-n.vx*n.uy}}e.adjugate=d;function A(n){let m=L(n);if(m===0)throw new Error("Matrix is not invertible.");return C(d(n),1/m)}e.inverse=A;function X(n){let m=Math.abs(n.y)===1?w.West:w.normalize(w.from(n.z,0,-n.x)),j=w.cross(n,m);return o(m,n,j)}e.buildTNB=X})($||($={}));var ot;(e=>{e.Identity={ux:1,vx:0,uy:0,vy:1};function t(d){return typeof d=="object"&&"ux"in d&&"vx"in d&&"uy"in d&&"vy"in d}e.isMatrix2=t;function o(d,A){if(Array.isArray(d)&&d.length>=4)return{ux:d[0],vx:d[1],uy:d[2],vy:d[3]};if(U.isVector2(d)&&A)return{ux:d.x,vx:A.x,uy:d.y,vy:A.y};throw new Error("Invalid input values for vector construction.")}e.from=o;function s(d){return{x:d.ux,y:d.uy}}e.c1=s;function a(d){return{x:d.vx,y:d.vy}}e.c2=a;function l(d){return{x:d.ux,y:d.vx}}e.r1=l;function y(d){return{x:d.uy,y:d.vy}}e.r2=y;function z(d,A){return t(A)?{ux:U.dot(l(d),s(A)),vx:U.dot(l(d),a(A)),uy:U.dot(y(d),s(A)),vy:U.dot(y(d),a(A))}:U.isVector2(A)?{x:U.dot(l(d),A),y:U.dot(y(d),A)}:{ux:d.ux*A,vx:d.vx*A,uy:d.uy*A,vy:d.vy*A}}e.mul=z;function p(d){return d.ux+d.vy}e.trace=p;function C(d){return d.ux*d.vy-d.vx*d.uy}e.determinant=C;function b(d){return{ux:d.ux,vx:d.uy,uy:d.vx,vy:d.vy}}e.transpose=b;function L(d){return{ux:d.vy,vx:-d.uy,uy:-d.vx,vy:d.ux}}e.cofactor=L;function v(d){return{ux:d.vy,vx:-d.vx,uy:-d.uy,vy:d.ux}}e.adjugate=v;function B(d){let A=C(d);if(A===0)throw new Error("Matrix is not invertible.");return z(v(d),1/A)}e.inverse=B})(ot||(ot={}));var U;(e=>{e.Zero={x:0,y:0},e.X={x:1,y:0},e.Y={x:0,y:1};function t(i){return typeof i=="object"&&"x"in i&&"y"in i}e.isVector2=t;function o(i,f){if(Array.isArray(i)&&i.length>=2)return{x:i[0],y:i[1]};if(typeof i=="number")return{x:i,y:f??i};throw new Error("Invalid input values for vector construction.")}e.from=o;function s(i){let{x:f,y:E}=i;return[f,E]}e.toArray=s;function a(i){return s(i).join(" ")}e.toString=a;function l(i){let[f,E]=i.split(" ").map(Number);return{x:f,y:E}}e.parse=l;function y(i){return Number.isNaN(i.x)||Number.isNaN(i.y)}e.isnan=y;function z(i){return!p(i)}e.isinf=z;function p(i){return Number.isFinite(i.x)&&Number.isFinite(i.y)}e.isfinite=p;function C(i,f){return i.x===f.x&&i.y===f.y}e.equal=C;function b(i,f){return{x:Math.min(i.x,f.x),y:Math.min(i.y,f.y)}}e.min=b;function L(i,f){return{x:Math.max(i.x,f.x),y:Math.max(i.y,f.y)}}e.max=L;function v(i,f,E){return{x:Math.min(Math.max(i.x,f.x),E.x),y:Math.min(Math.max(i.y,f.y),E.y)}}e.clamp=v;function B(i){return{x:Math.sign(i.x),y:Math.sign(i.y)}}e.sign=B;function d(i){return{x:Math.floor(i.x),y:Math.floor(i.y)}}e.floor=d;function A(i){return{x:Math.ceil(i.x),y:Math.ceil(i.y)}}e.ceil=A;function X(i){return{x:i.x-Math.floor(i.x),y:i.y-Math.floor(i.y)}}e.frac=X;function n(i){return{x:Math.round(i.x),y:Math.round(i.y)}}e.round=n;function m(i,f){return{x:i.x%f.x,y:i.y%f.y}}e.mod=m;function j(i){return{x:-i.x,y:-i.y}}e.neg=j;function lt(i){return{x:Math.abs(i.x),y:Math.abs(i.y)}}e.abs=lt;function V(i,...f){for(let E of f)i={x:i.x+E.x,y:i.y+E.y};return i}e.add=V;function H(i,...f){for(let E of f)i={x:i.x-E.x,y:i.y-E.y};return i}e.sub=H;function k(i,f){return t(f)?{x:i.x*f.x,y:i.y*f.y}:{x:i.x*f,y:i.y*f}}e.mul=k;function rt(i,f){return t(f)?{x:i.x/f.x,y:i.y/f.y}:{x:i.x/f,y:i.y/f}}e.div=rt;function ft(i){return{x:Math.sqrt(i.x),y:Math.sqrt(i.y)}}e.sqrt=ft;function et(i){return{x:Math.exp(i.x),y:Math.exp(i.y)}}e.exp=et;function O(i){return{x:Math.pow(2,i.x),y:Math.pow(2,i.y)}}e.exp2=O;function W(i){return{x:Math.log(i.x),y:Math.log(i.y)}}e.log=W;function T(i){return{x:Math.log2(i.x),y:Math.log2(i.y)}}e.log2=T;function nt(i){return{x:Math.log10(i.x),y:Math.log10(i.y)}}e.log10=nt;function yt(i,f){return t(f)?{x:Math.pow(i.x,f.x),y:Math.pow(i.y,f.y)}:{x:Math.pow(i.x,f),y:Math.pow(i.y,f)}}e.pow=yt;function dt(i){return{x:Math.sin(i.x),y:Math.sin(i.y)}}e.sin=dt;function xt(i){return{x:Math.asin(i.x),y:Math.asin(i.y)}}e.asin=xt;function pt(i){return{x:Math.sinh(i.x),y:Math.sinh(i.y)}}e.sinh=pt;function gt(i){return{x:Math.asinh(i.x),y:Math.asinh(i.y)}}e.asinh=gt;function zt(i){return{x:Math.cos(i.x),y:Math.cos(i.y)}}e.cos=zt;function mt(i){return{x:Math.acos(i.x),y:Math.acos(i.y)}}e.acos=mt;function wt(i){return{x:Math.cosh(i.x),y:Math.cosh(i.y)}}e.cosh=wt;function Et(i){return{x:Math.acosh(i.x),y:Math.acosh(i.y)}}e.acosh=Et;function Mt(i){return{x:Math.tan(i.x),y:Math.tan(i.y)}}e.tan=Mt;function At(i){return{x:Math.atan(i.x),y:Math.atan(i.y)}}e.atan=At;function bt(i){return{x:Math.tanh(i.x),y:Math.tanh(i.y)}}e.tanh=bt;function Rt(i){return{x:Math.atanh(i.x),y:Math.atanh(i.y)}}e.atanh=Rt;function q(i,f){return i.x*f.x+i.y*f.y}e.dot=q;function St(i,f){return i.x*f.y-i.y*f.x}e.wedge=St;function _(i){return Math.hypot(i.x,i.y)}e.length=_;function Tt(i){return rt(i,_(i))}e.normalize=Tt;function Ct(i,f){return _(H(i,f))}e.distance=Ct;function it(i,f){return k(f,q(i,f)/q(f,f))}e.project=it;function It(i,f){return H(i,it(i,f))}e.reject=It;function Dt(i,f){return H(i,k(f,2*q(f,i)))}e.reflect=Dt;function Lt(i,f,E){let N=-q(i,f),F=E*E*(1-N*N),K=Math.sqrt(1-F);return V(k(i,E),k(f,E*N-K))}e.refract=Lt;function Ot(i,f,E){return E===0?i:E===1?f:{x:i.x+E*(f.x-i.x),y:i.y+E*(f.y-i.y)}}e.lerp=Ot;function Nt(i,f,E){if(E===0)return i;if(E===1)return f;let N=q(i,f),F=Math.acos(N),K=Math.sqrt(1-N*N),vt=Math.sin((1-E)*F)/K,jt=Math.sin(E*F)/K;return V(k(i,vt),k(f,jt))}e.slerp=Nt;function Pt(i,f){let E=Math.cos(f),N=Math.sin(f),F=ot.from([E,-N,N,E]);return ot.mul(F,i)}e.rotate=Pt})(U||(U={}));import{WeatherType as xr,world as $t}from"@minecraft/server";import{Direction as M}from"@minecraft/server";import{system as hr,world as tt}from"@minecraft/server";import{system as Pr}from"@minecraft/server";import{BlockPermutation as jr,world as Ur}from"@minecraft/server";import{world as qr}from"@minecraft/server";import{Player as $r}from"@minecraft/server";import{system as qt}from"@minecraft/server";import{EquipmentSlot as Wr}from"@minecraft/server";import{system as Yt}from"@minecraft/server";import{MinecraftDimensionTypes as Zr,world as Qr}from"@minecraft/server";import{Player as dr,system as Ht,world as st}from"@minecraft/server";var x=class c{constructor(t,o){this.code=t,this.color=o,o&&(this.r=o>>16&255,this.g=o>>8&255,this.b=o&255)}static BLACK=new c("0",0);static DARK_BLUE=new c("1",170);static DARK_GREEN=new c("2",43520);static DARK_AQUA=new c("3",43690);static DARK_RED=new c("4",11141120);static DARK_PURPLE=new c("5",11141290);static GOLD=new c("6",16755200);static GRAY=new c("7",11184810);static DARK_GRAY=new c("8",5592405);static BLUE=new c("9",5592575);static GREEN=new c("a",5635925);static AQUA=new c("b",5636095);static RED=new c("c",16733525);static LIGHT_PURPLE=new c("d",16733695);static YELLOW=new c("e",16777045);static WHITE=new c("f",16777215);static MINECOIN_GOLD=new c("g",14603781);static MATERIAL_QUARTZ=new c("h",14931153);static MATERIAL_IRON=new c("i",13552330);static MATERIAL_NETHERITE=new c("j",4471355);static MATERIAL_REDSTONE=new c("m",9901575);static MATERIAL_COPPER=new c("n",11823181);static MATERIAL_GOLD=new c("p",14594349);static MATERIAL_EMERALD=new c("q",1155126);static MATERIAL_DIAMOND=new c("s",2931368);static MATERIAL_LAPIS=new c("t",2181499);static MATERIAL_AMETHYST=new c("u",10116294);static OBFUSCATED=new c("k");static BOLD=new c("l");static ITALIC=new c("o");static RESET=new c("r");static VALUES=[c.BLACK,c.DARK_BLUE,c.DARK_GREEN,c.DARK_AQUA,c.DARK_RED,c.DARK_PURPLE,c.GOLD,c.GRAY,c.DARK_GRAY,c.BLUE,c.GREEN,c.AQUA,c.RED,c.LIGHT_PURPLE,c.YELLOW,c.WHITE,c.MINECOIN_GOLD,c.MATERIAL_QUARTZ,c.MATERIAL_IRON,c.MATERIAL_NETHERITE,c.MATERIAL_REDSTONE,c.MATERIAL_COPPER,c.MATERIAL_GOLD,c.MATERIAL_EMERALD,c.MATERIAL_DIAMOND,c.MATERIAL_LAPIS,c.MATERIAL_AMETHYST,c.OBFUSCATED,c.BOLD,c.ITALIC,c.RESET];static ALL_COLORS=[c.BLACK,c.DARK_BLUE,c.DARK_GREEN,c.DARK_AQUA,c.DARK_RED,c.DARK_PURPLE,c.GOLD,c.GRAY,c.DARK_GRAY,c.BLUE,c.GREEN,c.AQUA,c.RED,c.LIGHT_PURPLE,c.YELLOW,c.WHITE,c.MINECOIN_GOLD,c.MATERIAL_QUARTZ,c.MATERIAL_IRON,c.MATERIAL_NETHERITE,c.MATERIAL_REDSTONE,c.MATERIAL_COPPER,c.MATERIAL_GOLD,c.MATERIAL_EMERALD,c.MATERIAL_DIAMOND,c.MATERIAL_LAPIS,c.MATERIAL_AMETHYST];r;g;b;static PREFIX="\xA7";toString(){return c.PREFIX+this.code}toRGB(){return this.color}toHex(){var t;return(t=this.color)==null?void 0:t.toString(16)}getRed(){return this.r}getGreen(){return this.g}getBlue(){return this.b}getCode(){return this.code}static stripColor(t){return t.replace(/ยง[0-9a-u]/g,"")}static findClosestColor(t,o,s){let a=Number.MAX_VALUE,l=c.WHITE;for(let y of c.ALL_COLORS)if(y.r&&y.g&&y.b){let z=Math.sqrt(Math.pow(y.r-t,2)+Math.pow(y.g-o,2)+Math.pow(y.b-s,2));z<a&&(a=z,l=y)}return l}},cr=class Zt{OpenObject="{";CloseObject="}";OpenArray="[";CloseArray="]";Comma=",";KeyValueSeparator=":";StringDelimiter='"';KeyDelimiter="";Indent="  ";NewLine=`
`;Space=" ";InlineThreshold=60;MaxDepth=1;IncludeClassNames=!0;FunctionValue="\u0192";NullValue="null";UndefinedValue="undefined";TrueValue="true";FalseValue="false";CycleValue="[...cycle...]";TruncatedObjectValue="{...}";OpenCloseObjectColor=x.YELLOW;OpenCloseArrayColor=x.AQUA;NumberColor=x.DARK_AQUA;StringColor=x.DARK_GREEN;BooleanColor=x.GOLD;NullColor=x.GOLD;KeyColor=x.GRAY;EscapeColor=x.GOLD;FunctionColor=x.GRAY;ClassColor=x.GRAY;ClassStyle=x.BOLD;CycleColor=x.DARK_RED;static DEFAULT=new Zt;stringify(t){return this.stringifyValue(t)}stringifyString(t){return this.StringColor+this.StringDelimiter+this.escapeString(t)+this.StringDelimiter+x.RESET}stringifyNumber(t){return this.NumberColor+t.toString()+x.RESET}stringifyBoolean(t){return this.BooleanColor+(t?this.TrueValue:this.FalseValue)+x.RESET}stringifyFunction(t){return this.FunctionColor+this.FunctionValue+x.RESET}stringifyNull(){return this.NullColor+this.NullValue+x.RESET}stringifyUndefined(){return this.NullColor+this.UndefinedValue+x.RESET}stringifyCycle(){return this.CycleColor+this.CycleValue+x.RESET}stringifyArray(t,o=0){let s=this.Indent.repeat(o);if(t.length===0)return this.OpenCloseArrayColor+this.OpenArray+this.CloseArray+x.RESET;let a=this.OpenCloseArrayColor+this.OpenArray+x.RESET+this.NewLine,l=this.OpenCloseArrayColor+this.OpenArray+x.RESET;return t.forEach((y,z)=>{a+=s+this.Indent+this.stringifyValue(y,o+1),a+=z<t.length-1?this.Comma+this.NewLine:this.NewLine,l+=this.stringifyValue(y,o+1),l+=z<t.length-1?this.Comma+this.Space:""}),a+=s+this.OpenCloseArrayColor+this.CloseArray+x.RESET,l+=this.OpenCloseArrayColor+this.CloseArray+x.RESET,l.length<this.InlineThreshold?l:a}stringifyTruncatedObject(t,o,s=0){return(this.IncludeClassNames?this.ClassColor+""+this.ClassStyle+o+x.RESET+this.Space:"")+this.TruncatedObjectValue}stringifyObject(t,o,s,a=0){let l=this.Indent.repeat(a),y=this.IncludeClassNames&&o!=="Object"?this.ClassColor+""+this.ClassStyle+o+x.RESET+this.Space:"";if(s.length===0)return y+this.OpenCloseObjectColor+this.OpenObject+this.CloseObject+x.RESET;let z=y+this.OpenCloseObjectColor+this.OpenObject+x.RESET+this.NewLine,p=y+this.OpenCloseObjectColor+this.OpenObject+x.RESET;return s.forEach(([C,b],L)=>{let v=this.stringifyValue(b,a+1);z+=l+this.Indent+this.KeyColor+this.KeyDelimiter+C+this.KeyDelimiter+x.RESET+this.KeyValueSeparator+this.Space+v,z+=L<s.length-1?this.Comma+this.NewLine:this.NewLine,p+=this.KeyColor+C+x.RESET+this.KeyValueSeparator+this.Space+v,p+=L<s.length-1?this.Comma+this.Space:""}),z+=l+this.OpenCloseObjectColor+this.CloseObject+x.RESET,p+=this.OpenCloseObjectColor+this.CloseObject+x.RESET,p.length<this.InlineThreshold?p:z}shouldTruncateObject(t,o,s=0){return!(o==="Object"||s<=this.MaxDepth||this.MaxDepth<=0)}stringifyValue(t,o=0){if(t===null)return this.stringifyNull();if(t===void 0)return this.stringifyUndefined();if(typeof t=="number")return this.stringifyNumber(t);if(typeof t=="string")return this.stringifyString(t);if(typeof t=="boolean")return this.stringifyBoolean(t);if(typeof t=="function")return this.stringifyFunction(t);if(this.isCycle(t))return this.stringifyCycle();if(this.markCycle(t),Array.isArray(t)){let s=this.stringifyArray(t,o?o+1:0);return this.clearCycle(t),s}if(typeof t=="object"){let s=t.constructor.name;if(this.shouldTruncateObject(t,s,o)){let a=this.stringifyTruncatedObject(t,s,o);return this.clearCycle(t),a}else{let a=new Set,l=Object.getPrototypeOf(t),y=Object.keys(l);for(;y.length>0;)y.forEach(b=>a.add(b)),l=Object.getPrototypeOf(l),y=Object.keys(l);Object.keys(t).forEach(b=>a.add(b)),a.delete("__cycleDetection__");let p=[...a].sort().map(b=>{try{return[b,t[b]??void 0]}catch{return[b,void 0]}}).filter(([,b])=>typeof b!="function"&&b!==void 0),C=this.stringifyObject(t,s,p,o);return this.clearCycle(t),C}}return this.clearCycle(t),x.RESET+t.toString()}escapeString(t){return t.replace(/\\/g,this.EscapeColor+"\\\\"+this.StringColor).replace(/"/g,this.EscapeColor+'\\"'+this.StringColor).replace(/\n/g,this.EscapeColor+"\\n"+this.StringColor).replace(/\r/g,this.EscapeColor+"\\r"+this.StringColor).replace(/\t/g,this.EscapeColor+"\\t"+this.StringColor)}markCycle(t){t.__cycleDetection__=!0}isCycle(t){return!!t.__cycleDetection__}clearCycle(t){delete t.__cycleDetection__}},D=class S{constructor(t,o,s=x.RESET){this.level=t,this.name=o,this.color=s}static All=new S(-2,"all");static Trace=new S(-2,"trace",x.DARK_AQUA);static Debug=new S(-1,"debug",x.AQUA);static Info=new S(0,"info",x.GREEN);static Warn=new S(1,"warn",x.GOLD);static Error=new S(2,"error",x.RED);static Fatal=new S(3,"fatal",x.DARK_RED);static Off=new S(100,"off");static values=[S.All,S.Trace,S.Debug,S.Info,S.Warn,S.Error,S.Fatal,S.Off];toString(){return this.color+this.name.toUpperCase()+x.RESET}static parse(t){t=t.toLowerCase();for(let s of S.values)if(s.name===t)return s;let o=parseInt(t);if(!isNaN(o)){for(let s of S.values)if(s.level===o)return s}}};function lr(e,t){return e==="*"?!0:e.includes("*")?e.startsWith("*")?t.endsWith(e.substring(1)):e.endsWith("*")?t.startsWith(e.substring(0,e.length-1)):new RegExp(e.replace(/\*/g,".*")).test(t):e===t}var R={level:D.Info,filter:["*"],outputTags:!1,formatFunction:(e,t,o,s=void 0)=>{let a=s!==void 0?`\xA77${s.map(l=>`[${l}]`).join("")}\xA7r`:"";return`[${e}][${x.MATERIAL_EMERALD}${t.name}${x.RESET}]${a} ${o}`},messagesJoinFunction:e=>e.join(" "),jsonFormatter:cr.DEFAULT,outputConfig:{[D.Trace.level]:[0,1],[D.Debug.level]:[0,1],[D.Info.level]:[0,1],[D.Warn.level]:[0,1,2],[D.Error.level]:[0,1,3],[D.Fatal.level]:[0,1,3]}},J=class Q{constructor(t,o=[]){this.name=t,this.tags=o}static initialized=!1;static init(){Q.initialized||(Q.initialized=!0,hr.afterEvents.scriptEventReceive.subscribe(t=>{if(t.id==="logging:level"||t.id==="log:level")if(!t.message)R.level=D.Info,tt.sendMessage(`${x.AQUA}Logging level set to ${x.BOLD}${R.level}`);else{let o=D.parse(t.message);o?(R.level=o,tt.sendMessage(`${x.AQUA}Logging level set to ${x.BOLD}${R.level}`)):tt.sendMessage(`${x.DARK_RED}Invalid logging level: ${t.message}`)}else(t.id==="logging:filter"||t.id==="log:filter")&&(t.message?R.filter=t.message.split(","):R.filter=["*"],tt.sendMessage(`${x.AQUA}Logging filter set to ${x.BOLD}${R.filter.join(", ")}`))}))}static setLevel(t){R.level=t}static setFilter(t){R.filter=t}static setFormatFunction(t){R.formatFunction=t}static setMessagesJoinFunction(t){R.messagesJoinFunction=t}static setTagsOutputVisibility(t){R.outputTags=t}static setJsonFormatter(t){R.jsonFormatter=t}static getOutputConfig(){return R.outputConfig}static getLogger(t,...o){return Q.initialized||Q.init(),new Q(t,o)}log(t,...o){if(!(t.level<R.level.level)){if(R.filter.length===0||this.tags.length===0){this.logRaw(t,...o);return}for(let s of R.filter)if(lr(s,this.name)){this.logRaw(t,...o);return}}}logRaw(t,...o){{let s=o.map(y=>y===void 0?x.GOLD+"undefined"+x.RESET:y===null?x.GOLD+"null"+x.RESET:y&&y instanceof Error?`${x.DARK_RED}${x.BOLD}${y.message}
${x.RESET}${x.GRAY}${x.ITALIC}${y.stack}${x.RESET}`:typeof y=="object"||Array.isArray(y)?R.jsonFormatter.stringify(y)+x.RESET:y.toString()+x.RESET),a=R.formatFunction(t,this,R.messagesJoinFunction(s),R.outputTags?this.tags:void 0),l=R.outputConfig[t.level]||[0,1];l.includes(0)&&tt.sendMessage(a),l.includes(1)&&(console.originalLog?console.originalLog(x.stripColor(a)):console.log(x.stripColor(a))),l.includes(2)&&console.warn(a),l.includes(3)&&console.error(a)}}trace(...t){this.log(D.Trace,...t)}debug(...t){this.log(D.Debug,...t)}info(...t){this.log(D.Info,...t)}warn(...t){this.log(D.Warn,...t)}error(...t){this.log(D.Error,...t)}fatal(...t){this.log(D.Fatal,...t)}},Lr=class h{static log=J.getLogger("vec3","vec3","bedrock-boost");static Zero=new h(0,0,0);static Down=new h(M.Down);static Up=new h(M.Up);static North=new h(M.North);static South=new h(M.South);static East=new h(M.East);static West=new h(M.West);x;y;z;constructor(t,o,s){if(t===M.Down)this.x=0,this.y=-1,this.z=0;else if(t===M.Up)this.x=0,this.y=1,this.z=0;else if(t===M.North)this.x=0,this.y=0,this.z=1;else if(t===M.South)this.x=0,this.y=0,this.z=-1;else if(t===M.East)this.x=1,this.y=0,this.z=0;else if(t===M.West)this.x=-1,this.y=0,this.z=0;else if(typeof t=="number")this.x=t,this.y=o,this.z=s;else if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2];else if(t instanceof h)this.x=t.x,this.y=t.y,this.z=t.z;else{if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid vector"),t),new Error("Invalid vector");this.x=t.x,this.y=t.y,this.z=t.z}}static from(t,o,s){if(t instanceof h)return t;if(typeof t=="number"&&o!==void 0&&s!==void 0)return new h(t,o,s);if(Array.isArray(t))return new h(t);if(t===M.Down)return h.Down;if(t===M.Up)return h.Up;if(t===M.North)return h.North;if(t===M.South)return h.South;if(t===M.East)return h.East;if(t===M.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,o,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}static _from(t,o,s){if(t instanceof h)return t;if(typeof t=="number"&&o!==void 0&&s!==void 0)return new h(t,o,s);if(Array.isArray(t))return new h(t);if(t===M.Down)return h.Down;if(t===M.Up)return h.Up;if(t===M.North)return h.North;if(t===M.South)return h.South;if(t===M.East)return h.East;if(t===M.West)return h.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw h.log.error(new Error("Invalid arguments"),t,o,s),new Error("Invalid arguments");return new h(t.x,t.y,t.z)}copy(){return h.from(this)}static fromYawPitch(t,o){let s;typeof t=="number"?(s=t,o=o):(s=t.y,o=t.x);let a=s*(Math.PI/180),l=o*(Math.PI/180),y=Math.cos(l)*Math.sin(a),z=Math.sin(l),p=Math.cos(l)*Math.cos(a);return new h(y,z,p)}toYawPitch(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),o=Math.atan2(t.x,t.z)*(180/Math.PI);return{x:Math.asin(t.y)*(180/Math.PI),y:o}}add(t,o,s){let a=h._from(t,o,s);return h.from(a.x+this.x,a.y+this.y,a.z+this.z)}subtract(t,o,s){let a=h._from(t,o,s);return h.from(this.x-a.x,this.y-a.y,this.z-a.z)}multiply(t,o,s){if(typeof t=="number"&&o===void 0&&s===void 0)return h.from(this.x*t,this.y*t,this.z*t);let a=h._from(t,o,s);return h.from(a.x*this.x,a.y*this.y,a.z*this.z)}scale(t){return h.from(this.x*t,this.y*t,this.z*t)}divide(t,o,s){if(typeof t=="number"&&o===void 0&&s===void 0){if(t===0)throw new Error("Cannot divide by zero");return h.from(this.x/t,this.y/t,this.z/t)}let a=h._from(t,o,s);if(a.x===0||a.y===0||a.z===0)throw new Error("Cannot divide by zero");return h.from(this.x/a.x,this.y/a.y,this.z/a.z)}normalize(){if(this.isZero())throw h.log.error(new Error("Cannot normalize zero-length vector")),new Error("Cannot normalize zero-length vector");let t=this.length();return h.from(this.x/t,this.y/t,this.z/t)}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}cross(t,o,s){let a=h._from(t,o,s);return h.from(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)}distance(t,o,s){let a=h._from(t,o,s);return Math.sqrt(this.distanceSquared(a))}distanceSquared(t,o,s){let a=h._from(t,o,s);return this.subtract(a).lengthSquared()}lerp(t,o){return!t||!o?h.from(this):o===1?h.from(t):o===0?h.from(this):h.from(this.x+(t.x-this.x)*o,this.y+(t.y-this.y)*o,this.z+(t.z-this.z)*o)}slerp(t,o){if(!t||!o)return h.from(this);if(o===1)return h.from(t);if(o===0)return h.from(this);let s=this.dot(t),a=Math.acos(s)*o,l=h.from(t).subtract(this.multiply(s)).normalize();return this.multiply(Math.cos(a)).add(l.multiply(Math.sin(a)))}dot(t,o,s){let a=h._from(t,o,s);return this.x*a.x+this.y*a.y+this.z*a.z}angleBetween(t,o,s){let a=h._from(t,o,s),l=this.dot(a),y=this.length()*a.length();return y===0?0:Math.acos(l/y)}projectOnto(t,o,s){let a=h._from(t,o,s);if(a.isZero())return h.Zero;let l=this.dot(a)/a.dot(a);return h.from(a.x*l,a.y*l,a.z*l)}reflect(t,o,s){let a=h._from(t,o,s),l=this.projectOnto(a);return this.subtract(l.multiply(2))}rotate(t,o){let s=o*Math.PI/180/2,a=Math.cos(s),l=t.x*Math.sin(s),y=t.y*Math.sin(s),z=t.z*Math.sin(s),p=this,C=a*a*p.x+2*y*a*p.z-2*z*a*p.y+l*l*p.x+2*y*l*p.y+2*z*l*p.z-z*z*p.x-y*y*p.x,b=2*l*y*p.x+y*y*p.y+2*z*y*p.z+2*a*z*p.x-z*z*p.y+a*a*p.y-2*l*a*p.z-l*l*p.y,L=2*l*z*p.x+2*y*z*p.y+z*z*p.z-2*a*y*p.x-y*y*p.z+2*a*l*p.y-l*l*p.z+a*a*p.z;return new h(C,b,L)}setX(t){return new h(t,this.y,this.z)}setY(t){return new h(this.x,t,this.z)}setZ(t){return new h(this.x,this.y,t)}distanceToLineSegment(t,o){let s=h.from(o).subtract(t);if(s.lengthSquared()===0)return this.subtract(t).length();let a=Math.max(0,Math.min(1,this.subtract(t).dot(s)/s.dot(s))),l=h.from(t).add(s.multiply(a));return this.subtract(l).length()}floor(){return new h(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}floorX(){return new h(Math.floor(this.x),this.y,this.z)}floorY(){return new h(this.x,Math.floor(this.y),this.z)}floorZ(){return new h(this.x,this.y,Math.floor(this.z))}ceil(){return new h(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}ceilX(){return new h(Math.ceil(this.x),this.y,this.z)}ceilY(){return new h(this.x,Math.ceil(this.y),this.z)}ceilZ(){return new h(this.x,this.y,Math.ceil(this.z))}round(){return new h(Math.round(this.x),Math.round(this.y),Math.round(this.z))}roundX(){return new h(Math.round(this.x),this.y,this.z)}roundY(){return new h(this.x,Math.round(this.y),this.z)}roundZ(){return new h(this.x,this.y,Math.round(this.z))}up(){return this.add(h.Up)}down(){return this.add(h.Down)}north(){return this.add(h.North)}south(){return this.add(h.South)}east(){return this.add(h.East)}west(){return this.add(h.West)}isZero(){return this.x===0&&this.y===0&&this.z===0}toArray(){return[this.x,this.y,this.z]}toDirection(){if(this.isZero())throw h.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),o=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z));if(o===t.x)return M.East;if(o===-t.x)return M.West;if(o===t.y)return M.Up;if(o===-t.y)return M.Down;if(o===t.z)return M.North;if(o===-t.z)return M.South;throw h.log.error(new Error("Cannot convert vector to direction"),this),new Error("Cannot convert vector to direction")}toBlockLocation(){return h.from((this.x<<0)-(this.x<0&&this.x!==this.x<<0?1:0),(this.y<<0)-(this.y<0&&this.y!==this.y<<0?1:0),(this.z<<0)-(this.z<0&&this.z!==this.z<<0?1:0))}almostEqual(t,o,s,a){try{let l;return typeof t!="number"&&s===void 0?(l=h._from(t,void 0,void 0),a=o):l=h._from(t,o,s),Math.abs(this.x-l.x)<=a&&Math.abs(this.y-l.y)<=a&&Math.abs(this.z-l.z)<=a}catch{return!1}}equals(t,o,s){try{let a=h._from(t,o,s);return this.x===a.x&&this.y===a.y&&this.z===a.z}catch{return!1}}toString(t="long",o=", "){let s=`${this.x+o+this.y+o+this.z}`;return t==="long"?`Vec3(${s})`:s}},Or=class Qt{static log=J.getLogger("Timings","timings");static lastTime=-1;static lastOperation="";static begin(t){this.end(),this.lastTime=new Date().getTime(),this.lastOperation=t}static end(){let t=new Date().getTime();this.lastTime>0&&Qt.log.debug(`Operation ${this.lastOperation} took ${t-this.lastTime}ms`),this.lastTime=-1}};var fr=J.getLogger("jobUtils","bedrock-boost","jobUtils");function Jt(e){return new Promise((t,o)=>{if(qt.runJob)qt.runJob(function*(){for(;;)try{let{done:s,value:a}=e.next();if(s){t(a);return}else yield}catch(s){o(s);return}}());else{fr.warn("system.runJob is not available. Running job in an inefficient way.");let s=()=>{let a=Date.now();for(;;)try{let{done:l,value:y}=e.next();if(l){t(y);return}else if(Date.now()-a>4){qt.runTimeout(s,1);return}}catch(l){o(l);return}};s()}})}var Kr=J.getLogger("itemUtils","bedrock-boost","itemUtils");var yr=class at{static log=J.getLogger("PulseScheduler","bedrock-boost","pulse-scheduler");items=[];period;currentTick=0;runId;nextIndex=0;executionSchedule=[];processor;constructor(t,o){if(o<=0)throw new Error("Period must be a positive integer.");if(!t||typeof t!="function")throw new Error("Processor function must be defined.");this.period=o,this.processor=t}add(t){this.push(t)}addAll(t){this.push(...t)}remove(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),t<this.nextIndex&&this.nextIndex--,this.recalculateExecutionSchedule())}removeIf(t){for(let o=this.items.length-1;o>=0;o--)t(this.items[o])&&this.remove(o)}getItems(){return this.items}start(){this.stop(),this.currentTick=0,this.nextIndex=0,this.runId=Yt.runInterval(()=>this.tick(),1)}stop(){this.runId!==void 0&&(Yt.clearRun(this.runId),this.runId=void 0)}recalculateExecutionSchedule(){let t=this.items.length;if(this.executionSchedule=new Array(this.period).fill(0),t===0)return;let o=this.period/t;for(let s=0;s<t;s++)this.executionSchedule[Math.round(o*s)%this.period]++}tick(){if(this.items.length===0){at.log.trace("No items to process.");return}let t=this.executionSchedule[this.currentTick];if(t===0){at.log.trace("No items to process this tick."),this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0);return}let o=0;for(;this.nextIndex<this.items.length&&o<t;this.nextIndex++){try{this.processor(this.items[this.nextIndex])}catch(s){at.log.error("Error processing item",s)}o++}this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0)}push(...t){return this.items.push(...t),this.recalculateExecutionSchedule(),this.items.length}pop(){let t=this.items.pop();return this.recalculateExecutionSchedule(),t}shift(){let t=this.items.shift();return this.recalculateExecutionSchedule(),t}unshift(...t){return this.items.unshift(...t),this.recalculateExecutionSchedule(),this.items.length}splice(t,o=0,...s){let a=this.items.splice(t,o,...s);return this.recalculateExecutionSchedule(),a}};var Xr=class Ft extends yr{static logger=J.getLogger("PlayerPulseScheduler","bedrock-boost","player-pulse-scheduler");constructor(t,o){super(s=>{s.isValid()?t(s):this.removeIf(a=>!a.isValid())},o),this.push(...st.getAllPlayers())}compareEntities(t,o){return t.id===o.id}start(){st.afterEvents.playerJoin.subscribe(t=>{let o=0,s=()=>{if(o++,o>10){Ft.logger.warn("Failed to push player to scheduler after 10 attempts.");return}try{let a=st.getEntity(t.playerId);a===void 0&&Ht.runTimeout(s,1),a instanceof dr&&this.push(a)}catch(a){Ft.logger.debug("Failed to push player to scheduler.",a),Ht.runTimeout(s,1)}};s()}),st.afterEvents.playerLeave.subscribe(t=>{this.removeIf(o=>!o.isValid()||o.id===t.playerId)}),super.start()}push(...t){let o=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.push(...o)}unshift(...t){let o=t.filter(s=>s.isValid()&&!this.items.some(a=>this.compareEntities(a,s)));return super.unshift(...o)}splice(t,o,...s){if(o===void 0)return super.splice(t);let a=s.filter(l=>!this.items.some(y=>this.compareEntities(y,l)));return super.splice(t,o,...a)}};function Gt(e){Jt(e()).then(()=>Gt(e))}var Xt="sunbeam:weather";$t.afterEvents.weatherChange.subscribe(e=>{e.dimension==="overworld"&&$t.setDynamicProperty(Xt,e.newWeather)});function ut(){return $t.getDynamicProperty(Xt)??xr.Clear}var pr=["minecraft:leather_helmet","minecraft:iron_helmet","minecraft:golden_helmet","minecraft:diamond_helmet","minecraft:netherite_helmet","minecraft:turtle_helmet","minecraft:chainmail_helmet"];function Vt(e){for(let t of pr){let o=`testfor @s[hasitem={location=slot.armor.head,item=${t}}]`;if(e.runCommand(o).successCount===1)return!0}return!1}function _t(e){let t=Math.cos(e.azimuth),o=Math.sin(e.azimuth),s=$.from([t,0,o,0,1,0,-o,0,t]),a=Math.cos(e.zenith),l=Math.sin(e.zenith),y=$.from([1,0,0,0,a,-l,0,l,a]);return $.mul(s,y)}function Bt(e,t,o){let s=w.dot(e,w.neg(t));return o*o*(1-s*s)>1?w.reflect(e,t):w.refract(e,t,o)}var Wt;(l=>(l.Default={azimuth:0,zenith:Math.PI/4},l.Infectious={azimuth:.6,zenith:.951},l.Interstellar={azimuth:.813,zenith:.667},l.Seraphic={azimuth:3.5841,zenith:.785398},l.Vanilla={azimuth:0,zenith:0}))(Wt||={});var zr=_t(Wt.Vanilla);function mr(e,t,o){return Math.min(Math.max(e,t),o)}function wr(){let e=(gr.getTimeOfDay()+1e3)%24e3;return mr(e/14e3,0,1)}function ht(){let e=Math.PI*wr(),t=w.rotate(w.East,w.South,e);return $.mul(zr,t)}var G="sunbeam";function tr(e){let t=e.sourceEntity,o="";switch(e.id){case`${G}:help`:switch(e.message){case"dts":o=`\xA7edts:
Logs the current direction to sun vector.
\xA7rUsage:
 - /scriptevent ${G}:dts`;break;case"wet":o=`\xA7ewet:
Logs the currently stored weather value.
\xA7rUsage:
 - /scriptevent ${G}:wet`;break;default:o=`\xA72--- Showing help page 1 of 1 ---
\xA7r/scriptevent ${G}:help [command: CommandName]
/scriptevent ${G}:dts
/scriptevent ${G}:wet`}break;case`${G}:dts`:o=`Direction to Sun: {${w.toString(ht())}}`;break;case`${G}:wet`:o=`Get weather result: ${ut()}`;break}t.sendMessage(o)}import{system as Sr}from"@minecraft/server";import{EntityComponentTypes as Er,MinecraftDimensionTypes as Mr,WeatherType as Ar,world as er}from"@minecraft/server";var ct=er.getDimension(Mr.overworld),br=.001;function Kt(e){return(e==null?void 0:e.typeId.includes("glass"))??!1}function nr(e,t,o){let s=ct.getBlockFromRay(e,t,o);if(s===void 0||!Kt(s.block))return s;let a=Kt(ct.getBlock(e))??!1;e=w.add(s.block.location,s.faceLocation,w.mul(t,br));let l=Kt(ct.getBlock(e))??!1;if(!a&&l){let y=w.fromDirection(s.face);t=Bt(t,y,1/1.5)}else if(a&&!l){let y=w.neg(w.fromDirection(s.face));t=Bt(t,y,1.5/1)}else if(!a&&!l)return s;return nr(e,t,o)}function rr(e){let t=ht();return nr(e,t,{includeLiquidBlocks:!0})===void 0}function Rr(e){return e.hasComponent(Er.OnFire)}function*ir(){if(!((er.getTimeOfDay()+540)%24e3>=13082)&&ut()===Ar.Clear)for(let e of ct.getEntities({families:["burns_in_sunlight"]})){if(!e||!e.isValid()||e.isInWater||Rr(e)||Vt(e))continue;let t=e.location,o=e.getHeadLocation();(rr(t)||rr(o))&&e.setOnFire(8,!0),yield}}Sr.afterEvents.scriptEventReceive.subscribe(tr);Gt(ir);
//# sourceMappingURL=main.js.map